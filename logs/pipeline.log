2025-09-15 22:02:07,779 - INFO - POST /train
2025-09-15 22:02:08,502 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:08] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:09,805 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:09] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:10,826 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:10] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:11,810 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:11] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:12,826 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:12] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:13,810 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:13] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:14,823 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:14] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:15,806 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:15] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:16,820 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:16] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:17,803 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:17] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:18,831 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:18] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:19,801 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:19] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:20,818 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:20] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:21,800 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:21] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:22,815 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:22] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:23,800 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:23] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:24,814 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:24] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:25,817 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:25] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:26,860 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:26] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:27,823 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:27] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:28,820 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:28] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:29,846 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:29] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:30,967 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:30] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:31,806 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:31] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:32,809 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:32] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:33,793 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:33] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:34,968 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:34] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:35,962 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:35] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:36,959 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:36] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:38,059 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:38] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:38,973 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:38] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:39,973 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:39] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:41,288 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:41] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:42,021 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:42] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:42,972 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:42] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:43,858 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:43] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:44,788 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:44] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:45,814 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:45] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:46,887 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:46] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:47,907 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:47] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:48,795 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:48] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:49,439 - INFO - Starting model training...
2025-09-15 22:02:49,806 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:49] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:50,802 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:50] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:51,811 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:51] "GET /logs HTTP/1.1" 200 -
2025-09-15 22:02:52,156 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__n_estimators': 200, 'classifier__max_depth': 5, 'classifier__learning_rate': 0.05, 'classifier__gamma': 0, 'classifier__colsample_bytree': 0.9}
2025-09-15 22:02:52,163 - INFO - F1 Score: 0.8892
2025-09-15 22:02:52,167 - INFO - ROC AUC: 0.9544
2025-09-15 22:02:52,182 - INFO - 
Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-15 22:02:52,188 - INFO - Model saved as datasets/processed\trained_model.pkl
2025-09-15 22:02:52,189 - ERROR - Training failed: name 'confusion_matrix' is not defined
2025-09-15 22:02:52,190 - INFO - 127.0.0.1 - - [15/Sep/2025 22:02:52] "[35m[1mPOST /train HTTP/1.1[0m" 500 -
2025-09-15 22:08:54,650 - INFO - 127.0.0.1 - - [15/Sep/2025 22:08:54] "GET /home HTTP/1.1" 200 -
2025-09-15 22:10:42,574 - INFO - 127.0.0.1 - - [15/Sep/2025 22:10:42] "GET /home HTTP/1.1" 200 -
2025-09-15 23:43:16,918 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:16] "GET /home HTTP/1.1" 200 -
2025-09-15 23:43:19,609 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:19] "GET /train HTTP/1.1" 200 -
2025-09-15 23:43:21,493 - INFO - POST /train
2025-09-15 23:43:22,817 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:22] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:23,824 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:23] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:24,814 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:24] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:25,859 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:25] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:26,894 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:26] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:27,804 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:27] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:28,835 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:28] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:29,835 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:29] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:30,829 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:30] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:31,800 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:31] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:32,981 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:32] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:33,799 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:33] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:34,982 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:34] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:36,208 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:36] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:36,981 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:36] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:37,971 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:37] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:39,042 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:39] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:39,977 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:39] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:41,074 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:41] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:42,033 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:42] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:42,988 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:42] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:43,957 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:43] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:44,982 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:44] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:45,954 - INFO - Starting model training...
2025-09-15 23:43:45,977 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:45] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:47,026 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:47] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:49,004 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:49] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:51,936 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:51] "GET /logs HTTP/1.1" 200 -
2025-09-15 23:43:52,598 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__n_estimators': 200, 'classifier__max_depth': 5, 'classifier__learning_rate': 0.05, 'classifier__gamma': 0, 'classifier__colsample_bytree': 0.9}
2025-09-15 23:43:52,602 - INFO - F1 Score: 0.8892
2025-09-15 23:43:52,606 - INFO - ROC AUC: 0.9544
2025-09-15 23:43:52,617 - INFO - 
Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-15 23:43:52,624 - INFO - Model saved as datasets/processed\trained_model.pkl
2025-09-15 23:43:52,624 - ERROR - Training failed: name 'confusion_matrix' is not defined
2025-09-15 23:43:52,626 - INFO - 127.0.0.1 - - [15/Sep/2025 23:43:52] "[35m[1mPOST /train HTTP/1.1[0m" 500 -
2025-09-16 00:10:20,967 - INFO - 127.0.0.1 - - [16/Sep/2025 00:10:20] "GET /train HTTP/1.1" 200 -
2025-09-16 00:10:29,830 - INFO - 127.0.0.1 - - [16/Sep/2025 00:10:29] "GET /home HTTP/1.1" 200 -
2025-09-16 00:10:52,573 - INFO - 127.0.0.1 - - [16/Sep/2025 00:10:52] "GET /predict HTTP/1.1" 200 -
2025-09-16 00:10:56,415 - INFO - 127.0.0.1 - - [16/Sep/2025 00:10:56] "GET /train HTTP/1.1" 200 -
2025-09-16 00:10:59,064 - INFO - POST /train
2025-09-16 00:11:00,411 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:00] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:01,395 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:01] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:02,404 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:02] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:03,409 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:03] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:04,390 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:04] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:05,424 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:05] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:06,390 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:06] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:07,396 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:07] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:08,414 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:08] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:09,433 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:09] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:10,981 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:10] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:11,391 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:11] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:13,233 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:13] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:14,004 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:14] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:14,977 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:14] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:16,162 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:16] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:16,963 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:16] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:17,969 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:17] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:19,161 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:19] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:19,975 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:19] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:20,966 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:20] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:22,182 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:22] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:23,018 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:23] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:23,279 - INFO - Starting model training...
2025-09-16 00:11:24,102 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:24] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:25,314 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:25] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:26,309 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:26] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:27,116 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:27] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:29,003 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:29] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:11:29,728 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__n_estimators': 200, 'classifier__max_depth': 5, 'classifier__learning_rate': 0.05, 'classifier__gamma': 0, 'classifier__colsample_bytree': 0.9}
2025-09-16 00:11:29,732 - INFO - F1 Score: 0.8892
2025-09-16 00:11:29,734 - INFO - ROC AUC: 0.9544
2025-09-16 00:11:29,746 - INFO - 
Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 00:11:29,754 - INFO - Model saved as datasets/processed\trained_model.pkl
2025-09-16 00:11:29,754 - ERROR - Training failed: name 'confusion_matrix' is not defined
2025-09-16 00:11:29,756 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:29] "[35m[1mPOST /train HTTP/1.1[0m" 500 -
2025-09-16 00:11:29,981 - INFO - 127.0.0.1 - - [16/Sep/2025 00:11:29] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:17,584 - INFO - POST /train
2025-09-16 00:24:18,291 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:18] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:19,599 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:19] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:20,609 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:20] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:21,595 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:21] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:22,619 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:22] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:23,593 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:23] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:24,591 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:24] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:25,583 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:25] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:26,624 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:26] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:27,588 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:27] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:28,606 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:28] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:29,600 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:29] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:30,707 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:30] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:31,589 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:31] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:32,601 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:32] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:33,586 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:33] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:34,609 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:34] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:35,618 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:35] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:36,608 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:36] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:37,598 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:37] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:38,700 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:38] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:39,623 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:39] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:39,786 - INFO - Starting model training...
2025-09-16 00:24:40,583 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:40] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:41,645 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:41] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:42,600 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:42] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:43,664 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:43] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:44,617 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:44] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:45,582 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:45] "GET /logs HTTP/1.1" 200 -
2025-09-16 00:24:45,936 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__n_estimators': 200, 'classifier__max_depth': 5, 'classifier__learning_rate': 0.05, 'classifier__gamma': 0, 'classifier__colsample_bytree': 0.9}
2025-09-16 00:24:45,940 - INFO - F1 Score: 0.8892
2025-09-16 00:24:45,942 - INFO - ROC AUC: 0.9544
2025-09-16 00:24:45,953 - INFO - 
Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 00:24:45,959 - INFO - Model saved as datasets/processed\trained_model.pkl
2025-09-16 00:24:45,960 - ERROR - Training failed: name 'confusion_matrix' is not defined
2025-09-16 00:24:45,960 - INFO - 127.0.0.1 - - [16/Sep/2025 00:24:45] "[35m[1mPOST /train HTTP/1.1[0m" 500 -
2025-09-16 07:53:43,046 - INFO - GET /predict → predict.html
2025-09-16 07:53:48,398 - INFO - POST /predict
2025-09-16 07:53:48,399 - INFO - Starting prediction pipeline
2025-09-16 07:53:48,406 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 07:53:48,406 - ERROR - Prediction failed: 'model_dir'
2025-09-16 07:53:48,406 - ERROR - Prediction failed: Prediction failed: 'model_dir'
2025-09-16 07:53:53,599 - INFO - GET /home → home.html
2025-09-16 07:55:43,509 - INFO - GET /home → home.html
2025-09-16 07:56:07,614 - INFO - GET /home → home.html
2025-09-16 14:54:48,239 - INFO - GET /predict → predict.html
2025-09-16 14:54:52,014 - INFO - POST /predict
2025-09-16 14:54:52,016 - INFO - Starting prediction pipeline
2025-09-16 14:54:52,025 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 14:54:52,025 - INFO - Loading model and preprocessing objects
2025-09-16 14:54:52,026 - ERROR - Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\best_model.pkl'
2025-09-16 14:54:52,026 - ERROR - Prediction failed: Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\best_model.pkl'
2025-09-16 14:55:39,402 - INFO - POST /predict
2025-09-16 14:55:39,402 - INFO - Starting prediction pipeline
2025-09-16 14:55:39,403 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 14:55:39,403 - INFO - Loading model and preprocessing objects
2025-09-16 14:55:40,123 - INFO - Preparing input data
2025-09-16 14:55:40,136 - INFO - Engineering features
2025-09-16 14:55:40,138 - INFO - Transforming skewed features
2025-09-16 14:55:40,146 - INFO - Scaling features
2025-09-16 14:55:40,148 - INFO - Applying PCA
2025-09-16 14:55:40,149 - INFO - Applying clustering
2025-09-16 14:55:40,207 - INFO - Making prediction
2025-09-16 14:55:40,216 - INFO - Prediction: 0, Probability: 0.0044
2025-09-16 14:55:40,218 - INFO - Prediction result: No Revenue, Probability: 0.0044
2025-09-16 14:55:40,219 - ERROR - Prediction failed: Object of type float32 is not JSON serializable
2025-09-16 15:11:21,144 - INFO - Logger initialized
2025-09-16 15:11:48,070 - INFO - Logger initialized
2025-09-16 15:11:53,241 - INFO - Logger initialized
2025-09-16 15:12:09,734 - INFO - Logger initialized
2025-09-16 15:12:15,145 - INFO - Logger initialized
2025-09-16 15:12:27,839 - INFO - Logger initialized
2025-09-16 15:12:45,832 - INFO - Logger initialized
2025-09-16 15:15:15,628 - INFO - Logger initialized
2025-09-16 15:15:33,603 - INFO - Logger initialized
2025-09-16 15:15:34,883 - INFO - Initializing Dash app at /eda/
2025-09-16 15:15:34,902 - WARNING - Plot file revenue_distribution.json not found
2025-09-16 15:15:34,902 - WARNING - Plot file correlation_heatmap.json not found
2025-09-16 15:15:34,902 - WARNING - Plot file bounce_exit_scatter.json not found
2025-09-16 15:15:34,903 - WARNING - Plot file visitor_type_pie.json not found
2025-09-16 15:15:34,903 - WARNING - Plot file confusion_matrix.json not found
2025-09-16 15:15:34,903 - WARNING - Plot file roc_curve.json not found
2025-09-16 15:15:34,903 - WARNING - Plot file feature_importance.json not found
2025-09-16 15:15:34,904 - INFO - Dash app layout set up successfully
2025-09-16 15:15:37,786 - INFO - Logger initialized
2025-09-16 15:15:38,720 - INFO - Initializing Dash app at /eda/
2025-09-16 15:15:38,732 - WARNING - Plot file revenue_distribution.json not found
2025-09-16 15:15:38,732 - WARNING - Plot file correlation_heatmap.json not found
2025-09-16 15:15:38,732 - WARNING - Plot file bounce_exit_scatter.json not found
2025-09-16 15:15:38,733 - WARNING - Plot file visitor_type_pie.json not found
2025-09-16 15:15:38,733 - WARNING - Plot file confusion_matrix.json not found
2025-09-16 15:15:38,733 - WARNING - Plot file roc_curve.json not found
2025-09-16 15:15:38,733 - WARNING - Plot file feature_importance.json not found
2025-09-16 15:15:38,734 - INFO - Dash app layout set up successfully
2025-09-16 15:17:11,235 - INFO - GET /predict → predict.html
2025-09-16 15:17:14,313 - INFO - GET / → redirect to /home
2025-09-16 15:17:37,324 - INFO - GET /train → train.html
2025-09-16 15:17:39,114 - INFO - POST /train
2025-09-16 15:17:39,114 - INFO - Starting model training pipeline
2025-09-16 15:17:39,124 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 15:17:39,124 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 15:17:39,124 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 15:17:39,194 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 15:17:39,195 - INFO - Using pre-existing train/test split from 'Set' column
2025-09-16 15:17:39,205 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 15:17:39,206 - INFO - Training and tuning XGBoost
2025-09-16 15:17:47,094 - INFO - XGBoost - Best F1 Score: 0.8953, Test F1 Score: 0.8892
2025-09-16 15:17:47,094 - INFO - Training and tuning LightGBM
2025-09-16 15:18:00,351 - INFO - LightGBM - Best F1 Score: 0.8971, Test F1 Score: 0.8882
2025-09-16 15:18:00,352 - INFO - Training and tuning RandomForest
2025-09-16 15:21:10,154 - INFO - RandomForest - Best F1 Score: 0.9014, Test F1 Score: 0.9064
2025-09-16 15:21:10,157 - INFO - Best model: RandomForest
2025-09-16 15:21:10,476 - INFO - Detailed evaluation of RandomForest:
2025-09-16 15:21:10,477 - INFO - Accuracy: 0.9053
2025-09-16 15:21:10,481 - INFO - Precision: 0.8961
2025-09-16 15:21:10,485 - INFO - Recall: 0.9169
2025-09-16 15:21:10,488 - INFO - F1 Score: 0.9064
2025-09-16 15:21:10,492 - INFO - ROC AUC: 0.9647
2025-09-16 15:21:10,502 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.92      0.89      0.90      2060
           1       0.90      0.92      0.91      2059

    accuracy                           0.91      4119
   macro avg       0.91      0.91      0.91      4119
weighted avg       0.91      0.91      0.91      4119

2025-09-16 15:21:10,607 - INFO - Best model saved to models\best_model.pkl
2025-09-16 15:21:10,607 - INFO - Generating evaluation plots
2025-09-16 15:21:10,759 - INFO - Confusion matrix saved
2025-09-16 15:21:10,802 - INFO - ROC curve saved
2025-09-16 15:21:10,819 - INFO - Generating feature importance plot
2025-09-16 15:21:10,834 - ERROR - Failed to generate evaluation plots: name 'px' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 177, in generate_evaluation_plots
    fig_fi = px.bar(x=feature_importance, y=features, orientation='h',
             ^^
NameError: name 'px' is not defined
2025-09-16 15:21:10,835 - ERROR - Model training failed: name 'px' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 133, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model, model_dir)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 177, in generate_evaluation_plots
    fig_fi = px.bar(x=feature_importance, y=features, orientation='h',
             ^^
NameError: name 'px' is not defined
2025-09-16 15:21:10,836 - ERROR - Training failed: name 'px' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 133, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model, model_dir)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 177, in generate_evaluation_plots
    fig_fi = px.bar(x=feature_importance, y=features, orientation='h',
             ^^
NameError: name 'px' is not defined
2025-09-16 15:22:18,260 - INFO - GET /home → home.html
2025-09-16 15:23:09,807 - INFO - GET /predict → predict.html
2025-09-16 15:23:16,745 - INFO - POST /predict
2025-09-16 15:23:16,747 - INFO - Starting prediction pipeline
2025-09-16 15:23:16,749 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 15:23:16,749 - INFO - Loading model and preprocessing objects
2025-09-16 15:23:16,910 - INFO - Preparing input data
2025-09-16 15:23:16,913 - INFO - Engineering features
2025-09-16 15:23:16,915 - INFO - Transforming skewed features
2025-09-16 15:23:16,918 - INFO - Handling missing values
2025-09-16 15:23:16,919 - ERROR - Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\prediction_pipeline.py", line 69, in predict
    imputer = joblib.load(os.path.join(processed_dir, 'imputer.pkl'))  # Load training imputer
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
2025-09-16 15:23:16,921 - ERROR - Prediction failed: Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\prediction_pipeline.py", line 69, in predict
    imputer = joblib.load(os.path.join(processed_dir, 'imputer.pkl'))  # Load training imputer
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 64, in predict_route
    prediction, probability = predict(data)
                              ^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\prediction_pipeline.py", line 95, in predict
    raise Exception(f"Prediction failed: {str(e)}")
Exception: Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
2025-09-16 15:23:22,690 - INFO - Logger initialized
2025-09-16 15:23:23,784 - INFO - Initializing Dash app at /eda/
2025-09-16 15:23:23,795 - WARNING - Plot file revenue_distribution.json not found
2025-09-16 15:23:23,795 - WARNING - Plot file correlation_heatmap.json not found
2025-09-16 15:23:23,796 - WARNING - Plot file bounce_exit_scatter.json not found
2025-09-16 15:23:23,796 - WARNING - Plot file visitor_type_pie.json not found
2025-09-16 15:23:23,814 - WARNING - Plot file feature_importance.json not found
2025-09-16 15:23:23,816 - INFO - Dash app layout set up successfully
2025-09-16 15:23:23,864 - INFO - POST /predict
2025-09-16 15:23:23,867 - INFO - Starting prediction pipeline
2025-09-16 15:23:23,868 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 15:23:23,868 - INFO - Loading model and preprocessing objects
2025-09-16 15:23:24,067 - INFO - Preparing input data
2025-09-16 15:23:24,070 - INFO - Engineering features
2025-09-16 15:23:24,076 - INFO - Transforming skewed features
2025-09-16 15:23:24,082 - INFO - Handling missing values
2025-09-16 15:23:24,083 - ERROR - Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\prediction_pipeline.py", line 69, in predict
    imputer = joblib.load(os.path.join(processed_dir, 'imputer.pkl'))  # Load training imputer
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
2025-09-16 15:23:24,085 - ERROR - Prediction failed: Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\prediction_pipeline.py", line 69, in predict
    imputer = joblib.load(os.path.join(processed_dir, 'imputer.pkl'))  # Load training imputer
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 64, in predict_route
    prediction, probability = predict(data)
                              ^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\prediction_pipeline.py", line 95, in predict
    raise Exception(f"Prediction failed: {str(e)}")
Exception: Prediction failed: [Errno 2] No such file or directory: 'datasets/processed\\imputer.pkl'
2025-09-16 15:42:54,964 - INFO - Logger initialized
2025-09-16 15:42:55,812 - INFO - Initializing Dash app at /eda/
2025-09-16 15:42:55,824 - WARNING - Plot file revenue_distribution.json not found
2025-09-16 15:42:55,825 - WARNING - Plot file correlation_heatmap.json not found
2025-09-16 15:42:55,825 - WARNING - Plot file bounce_exit_scatter.json not found
2025-09-16 15:42:55,825 - WARNING - Plot file visitor_type_pie.json not found
2025-09-16 15:42:55,826 - WARNING - Plot file feature_importance.json not found
2025-09-16 15:42:55,827 - INFO - Dash app layout set up successfully
2025-09-16 15:44:19,948 - INFO - Logger initialized
2025-09-16 15:44:20,721 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 15:44:20,732 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 15:44:20,732 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 15:44:20,732 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 15:44:20,733 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 15:44:20,733 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 15:44:20,733 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 15:44:20,733 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 15:44:20,733 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 15:44:20,734 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 15:44:20,734 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 15:44:20,734 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 15:44:20,734 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 15:44:20,734 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 15:44:20,734 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 15:44:20,734 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 15:44:20,735 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 15:44:20,736 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 15:44:20,737 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 15:44:41,299 - INFO - Logger initialized
2025-09-16 15:44:42,116 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 15:44:42,130 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 15:44:42,130 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 15:44:42,130 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 15:44:42,131 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 15:44:42,131 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 15:44:42,131 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 15:44:42,131 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 15:44:42,132 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 15:44:42,132 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 15:44:42,132 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 15:44:42,132 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 15:44:42,132 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 15:44:42,132 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 15:44:42,133 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 15:44:42,133 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 15:44:42,133 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 15:44:42,133 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 15:44:42,133 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 15:44:42,133 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 15:44:42,134 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 15:44:42,134 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 15:44:42,134 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 15:44:42,134 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 15:44:42,134 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 15:44:42,134 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 15:44:42,134 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 15:44:42,136 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 15:44:52,826 - INFO - Logger initialized
2025-09-16 15:44:52,831 - INFO - No GPU detected - using CPU only
2025-09-16 15:44:53,559 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 15:44:53,569 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 15:44:53,570 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 15:44:53,570 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 15:44:53,571 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 15:44:53,571 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 15:44:53,571 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 15:44:53,571 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 15:44:53,571 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 15:44:53,571 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 15:44:53,571 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 15:44:53,572 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 15:44:53,573 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 15:44:53,573 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 15:44:53,573 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 15:44:53,573 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 15:44:53,573 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 15:44:53,573 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 15:44:53,574 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 15:45:15,350 - INFO - Logger initialized
2025-09-16 15:45:15,356 - INFO - No GPU detected - using CPU only
2025-09-16 15:45:16,090 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 15:45:16,100 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 15:45:16,100 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 15:45:16,100 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 15:45:16,100 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 15:45:16,101 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 15:45:16,101 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 15:45:16,101 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 15:45:16,101 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 15:45:16,101 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 15:45:16,101 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 15:45:16,102 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 15:45:16,102 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 15:45:16,102 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 15:45:16,102 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 15:45:16,102 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 15:45:16,102 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 15:45:16,102 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 15:45:16,103 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 15:45:16,104 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 15:45:16,105 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 15:45:28,074 - INFO - Logger initialized
2025-09-16 15:45:28,080 - INFO - No GPU detected - using CPU only
2025-09-16 15:45:28,810 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 15:45:28,821 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 15:45:28,821 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 15:45:28,821 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 15:45:28,821 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 15:45:28,822 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 15:45:28,824 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 15:45:28,824 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 15:45:28,824 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 15:45:28,824 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 15:45:28,824 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 15:45:28,825 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 15:45:28,825 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 15:45:28,825 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 15:45:28,825 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 15:45:28,825 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 15:45:28,825 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 15:45:28,826 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 15:45:28,826 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 15:45:28,826 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 15:45:28,827 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 15:45:31,347 - INFO - Logger initialized
2025-09-16 15:45:31,352 - INFO - No GPU detected - using CPU only
2025-09-16 15:45:32,115 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 15:45:32,127 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 15:45:32,127 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 15:45:32,127 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 15:45:32,128 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 15:45:32,128 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 15:45:32,128 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 15:45:32,128 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 15:45:32,128 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 15:45:32,128 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 15:45:32,129 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 15:45:32,130 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 15:45:32,131 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 15:45:43,344 - INFO - GET /home → home.html
2025-09-16 15:46:00,133 - INFO - GET /train → train.html
2025-09-16 15:46:11,662 - INFO - POST /train
2025-09-16 15:46:11,662 - INFO - Starting model training pipeline (aligned with model_training.py)
2025-09-16 15:46:11,663 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 15:46:11,663 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 15:46:11,663 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 15:46:11,718 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 15:46:11,726 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 15:46:11,727 - INFO - Training and tuning LogisticRegression
2025-09-16 15:46:15,010 - INFO - LogisticRegression - Best F1 Score: 0.8697, Test F1 Score: 0.8620
2025-09-16 15:46:15,010 - INFO - Training and tuning RandomForest
2025-09-16 15:49:30,425 - INFO - RandomForest - Best F1 Score: 0.9014, Test F1 Score: 0.9064
2025-09-16 15:49:30,426 - INFO - Training and tuning GradientBoosting
2025-09-16 15:50:44,335 - INFO - Logger initialized
2025-09-16 15:50:44,341 - INFO - No GPU detected - using CPU only
2025-09-16 15:50:45,058 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 15:50:45,068 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 15:50:45,068 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 15:50:45,069 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 15:50:45,070 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 15:50:45,071 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 15:50:45,071 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 15:50:45,071 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 15:50:45,071 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 15:50:45,071 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 15:50:45,072 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 15:50:45,072 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 15:50:45,072 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 15:50:45,073 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 15:50:45,113 - INFO - POST /train
2025-09-16 15:50:45,113 - INFO - Starting model training pipeline (aligned with model_training.py)
2025-09-16 15:50:45,116 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 15:50:45,116 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 15:50:45,116 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 15:50:45,172 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 15:50:45,180 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 15:50:45,180 - INFO - Training and tuning LogisticRegression
2025-09-16 15:50:48,944 - INFO - LogisticRegression - Best F1 Score: 0.8697, Test F1 Score: 0.8620
2025-09-16 15:50:48,944 - INFO - Training and tuning RandomForest
2025-09-16 15:54:35,373 - INFO - RandomForest - Best F1 Score: 0.9014, Test F1 Score: 0.9064
2025-09-16 15:54:35,374 - INFO - Training and tuning GradientBoosting
2025-09-16 15:55:19,803 - ERROR - Model training failed: 
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\_parallel_backends.py", line 620, in __call__
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\parallel.py", line 288, in __call__
    return [func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\parallel.py", line 288, in <listcomp>
    return [func(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\parallel.py", line 123, in __call__
    return self.function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\model_selection\_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\pipeline.py", line 405, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\ensemble\_gb.py", line 538, in fit
    n_stages = self._fit_stages(
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\ensemble\_gb.py", line 615, in _fit_stages
    raw_predictions = self._fit_stage(
                      ^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\ensemble\_gb.py", line 257, in _fit_stage
    tree.fit(X, residual, sample_weight=sample_weight, check_input=False)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\tree\_classes.py", line 1247, in fit
    super().fit(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\tree\_classes.py", line 379, in fit
    builder.build(self.tree_, X, y, sample_weight)
KeyboardInterrupt

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\externals\loky\process_executor.py", line 428, in _process_worker
    r = call_item()
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\externals\loky\process_executor.py", line 275, in __call__
    return self.fn(*self.args, **self.kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\_parallel_backends.py", line 625, in __call__
    raise WorkerInterrupt() from e
joblib.my_exceptions.WorkerInterrupt
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 147, in train_model
    search.fit(X_train, y_train)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py", line 874, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py", line 1768, in _run_search
    evaluate_candidates(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py", line 821, in evaluate_candidates
    out = parallel(
          ^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\parallel.py", line 63, in __call__
    return super().__call__(iterable_with_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\parallel.py", line 1098, in __call__
    self.retrieve()
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\parallel.py", line 975, in retrieve
    self._output.extend(job.get(timeout=self.timeout))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\_parallel_backends.py", line 567, in wrap_future_result
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
joblib.my_exceptions.WorkerInterrupt
2025-09-16 17:25:11,800 - INFO - Logger initialized
2025-09-16 17:26:02,958 - INFO - Logger initialized
2025-09-16 17:26:03,024 - INFO - No GPU detected - using CPU only
2025-09-16 17:26:03,815 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:26:03,828 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:26:03,828 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:26:03,828 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:26:03,829 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:26:03,829 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:26:03,829 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:26:03,829 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:26:03,829 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:26:03,829 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:26:03,830 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:26:03,831 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:26:03,833 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:26:06,369 - INFO - Logger initialized
2025-09-16 17:26:06,403 - INFO - No GPU detected - using CPU only
2025-09-16 17:26:07,117 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:26:07,128 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:26:07,128 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:26:07,128 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:26:07,128 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:26:07,128 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:26:07,128 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:26:07,128 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:26:07,129 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:26:07,129 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:26:07,129 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:26:07,129 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:26:07,129 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:26:07,130 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:26:07,130 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:26:07,130 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:26:07,130 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:26:07,131 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:26:07,132 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:26:07,133 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:26:19,858 - INFO - GET /train → train.html
2025-09-16 17:26:22,018 - INFO - GET /home → home.html
2025-09-16 17:26:39,003 - INFO - GET /train → train.html
2025-09-16 17:26:40,468 - INFO - POST /train
2025-09-16 17:26:40,468 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 17:26:40,470 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 17:26:40,470 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 17:26:40,471 - INFO - Starting data preprocessing
2025-09-16 17:26:40,472 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 17:26:40,472 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 17:26:40,579 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 17:26:40,592 - INFO - Removing 125 duplicate rows
2025-09-16 17:26:40,600 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 17:26:40,666 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 17:26:40,667 - INFO - Converting boolean columns to integers
2025-09-16 17:26:40,668 - INFO - Applying target encoding for Month
2025-09-16 17:26:40,673 - INFO - Applying frequency encoding for VisitorType
2025-09-16 17:26:40,675 - INFO - Creating interaction features
2025-09-16 17:26:40,677 - INFO - Calculating engagement score
2025-09-16 17:26:40,678 - INFO - Transforming skewed features
2025-09-16 17:26:40,714 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 17:26:40,724 - INFO - Scaling features
2025-09-16 17:26:40,733 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 17:26:40,733 - INFO - Applying PCA for dimensionality reduction
2025-09-16 17:26:40,759 - INFO - PCA reduced features to: 15 components
2025-09-16 17:26:40,760 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 17:26:40,760 - INFO - Applying K-Means clustering
2025-09-16 17:26:52,208 - INFO - Optimal number of clusters: 3
2025-09-16 17:26:52,271 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 17:26:52,271 - INFO - Combining PCA features with cluster labels
2025-09-16 17:26:52,272 - INFO - Saving preprocessed data
2025-09-16 17:26:52,541 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 17:26:52,542 - INFO - Data preprocessing completed successfully
2025-09-16 17:26:52,543 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 17:26:52,544 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 17:26:52,589 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 17:26:52,596 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 17:26:52,597 - INFO - Training and tuning LogisticRegression
2025-09-16 17:26:53,078 - INFO - LogisticRegression - Best F1 Score: 0.6509, Test F1 Score: 0.6638
2025-09-16 17:26:53,078 - INFO - Training and tuning RandomForest
2025-09-16 17:28:21,779 - INFO - Logger initialized
2025-09-16 17:28:21,809 - INFO - No GPU detected - using CPU only
2025-09-16 17:28:22,536 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:28:22,545 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:28:22,545 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:28:22,546 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:28:22,547 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:28:22,548 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:28:22,549 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:28:22,589 - INFO - POST /train
2025-09-16 17:28:22,589 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 17:28:22,591 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 17:28:22,592 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 17:28:22,592 - INFO - Starting data preprocessing
2025-09-16 17:28:22,595 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 17:28:22,596 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 17:28:22,617 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 17:28:22,624 - INFO - Removing 125 duplicate rows
2025-09-16 17:28:22,630 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 17:28:22,700 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 17:28:22,701 - INFO - Converting boolean columns to integers
2025-09-16 17:28:22,702 - INFO - Applying target encoding for Month
2025-09-16 17:28:22,704 - INFO - Applying frequency encoding for VisitorType
2025-09-16 17:28:22,706 - INFO - Creating interaction features
2025-09-16 17:28:22,708 - INFO - Calculating engagement score
2025-09-16 17:28:22,709 - INFO - Transforming skewed features
2025-09-16 17:28:22,752 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 17:28:22,839 - INFO - Scaling features
2025-09-16 17:28:22,850 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 17:28:22,851 - INFO - Applying PCA for dimensionality reduction
2025-09-16 17:28:22,860 - INFO - PCA reduced features to: 15 components
2025-09-16 17:28:22,862 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 17:28:22,862 - INFO - Applying K-Means clustering
2025-09-16 17:28:33,964 - INFO - Optimal number of clusters: 3
2025-09-16 17:28:34,029 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 17:28:34,030 - INFO - Combining PCA features with cluster labels
2025-09-16 17:28:34,030 - INFO - Saving preprocessed data
2025-09-16 17:28:34,244 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 17:28:34,244 - INFO - Data preprocessing completed successfully
2025-09-16 17:28:34,246 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 17:28:34,246 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 17:28:34,289 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 17:28:34,294 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 17:28:34,295 - INFO - Training and tuning LogisticRegression
2025-09-16 17:28:34,769 - INFO - LogisticRegression - Best F1 Score: 0.6509, Test F1 Score: 0.6638
2025-09-16 17:28:34,769 - INFO - Training and tuning RandomForest
2025-09-16 17:30:18,968 - INFO - Logger initialized
2025-09-16 17:30:19,003 - INFO - No GPU detected - using CPU only
2025-09-16 17:30:19,728 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:30:19,737 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:30:19,737 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:30:19,737 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:30:19,737 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:30:19,738 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:30:19,738 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:30:19,738 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:30:19,738 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:30:19,738 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:30:19,738 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:30:19,738 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:30:19,739 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:30:19,739 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:30:19,739 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:30:19,739 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:30:19,739 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:30:19,739 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:30:19,740 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:30:19,742 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:33:50,576 - INFO - Logger initialized
2025-09-16 17:33:50,609 - INFO - No GPU detected - using CPU only
2025-09-16 17:33:51,315 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:33:51,325 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:33:51,326 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:33:51,327 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:33:51,327 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:33:51,327 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:33:51,327 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:33:51,327 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:33:51,327 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:33:51,327 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:33:51,328 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:33:51,330 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:33:53,782 - INFO - Logger initialized
2025-09-16 17:33:53,815 - INFO - No GPU detected - using CPU only
2025-09-16 17:33:54,566 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:33:54,578 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:33:54,578 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:33:54,578 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:33:54,578 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:33:54,579 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:33:54,579 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:33:54,579 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:33:54,579 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:33:54,579 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:33:54,579 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:33:54,579 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:33:54,580 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:33:54,581 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:33:54,581 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:33:54,581 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:33:54,581 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:33:54,581 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:33:54,581 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:33:54,581 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:33:54,582 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:34:11,447 - INFO - GET /train → train.html
2025-09-16 17:34:12,918 - INFO - POST /train
2025-09-16 17:34:12,919 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 17:34:12,920 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 17:34:12,920 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 17:34:12,920 - INFO - Starting data preprocessing
2025-09-16 17:34:12,921 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 17:34:12,921 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 17:34:12,940 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 17:34:12,946 - INFO - Removing 125 duplicate rows
2025-09-16 17:34:12,951 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 17:34:13,016 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 17:34:13,016 - INFO - Converting boolean columns to integers
2025-09-16 17:34:13,017 - INFO - Applying target encoding for Month
2025-09-16 17:34:13,019 - INFO - Applying frequency encoding for VisitorType
2025-09-16 17:34:13,021 - INFO - Creating interaction features
2025-09-16 17:34:13,023 - INFO - Calculating engagement score
2025-09-16 17:34:13,024 - INFO - Transforming skewed features
2025-09-16 17:34:13,063 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 17:34:13,137 - INFO - Scaling features
2025-09-16 17:34:13,146 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 17:34:13,147 - INFO - Applying PCA for dimensionality reduction
2025-09-16 17:34:13,154 - INFO - PCA reduced features to: 15 components
2025-09-16 17:34:13,155 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 17:34:13,156 - INFO - Applying K-Means clustering
2025-09-16 17:34:24,594 - INFO - Optimal number of clusters: 3
2025-09-16 17:34:24,660 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 17:34:24,660 - INFO - Combining PCA features with cluster labels
2025-09-16 17:34:24,661 - INFO - Saving preprocessed data
2025-09-16 17:34:24,874 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 17:34:24,874 - INFO - Data preprocessing completed successfully
2025-09-16 17:34:24,876 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 17:34:24,877 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 17:34:24,920 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 17:34:24,924 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 17:34:24,928 - INFO - Using 50.0% of data (4882 samples) for hyperparameter tuning
2025-09-16 17:34:24,928 - INFO - 
Training and tuning XGBoost...
2025-09-16 17:34:24,930 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 17:34:32,409 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__n_estimators': 200, 'classifier__max_depth': 5, 'classifier__learning_rate': 0.05, 'classifier__gamma': 0, 'classifier__colsample_bytree': 0.9}
2025-09-16 17:34:32,410 - INFO - F1 Score: 0.6421, ROC AUC: 0.9239
2025-09-16 17:34:32,410 - INFO - XGBoost - Best F1 Score: 0.6381, Test F1 Score: 0.6421
2025-09-16 17:34:32,410 - INFO - 
Training and tuning LightGBM...
2025-09-16 17:34:32,411 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 17:35:03,528 - INFO - Best parameters: {'classifier__subsample': 0.9, 'classifier__num_leaves': 31, 'classifier__n_estimators': 100, 'classifier__max_depth': 7, 'classifier__learning_rate': 0.05, 'classifier__colsample_bytree': 0.9}
2025-09-16 17:35:03,529 - INFO - F1 Score: 0.6540, ROC AUC: 0.9183
2025-09-16 17:35:03,529 - INFO - LightGBM - Best F1 Score: 0.6741, Test F1 Score: 0.6540
2025-09-16 17:35:03,529 - INFO - 
Training and tuning RandomForest...
2025-09-16 17:35:03,531 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 17:35:38,536 - INFO - Best parameters: {'classifier__n_estimators': 200, 'classifier__min_samples_split': 2, 'classifier__min_samples_leaf': 2, 'classifier__max_features': 0.9, 'classifier__max_depth': 7, 'classifier__bootstrap': True}
2025-09-16 17:35:38,537 - INFO - F1 Score: 0.6522, ROC AUC: 0.9176
2025-09-16 17:35:38,538 - INFO - RandomForest - Best F1 Score: 0.6710, Test F1 Score: 0.6522
2025-09-16 17:35:38,538 - INFO - 
Training and tuning GradientBoosting...
2025-09-16 17:35:38,540 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 17:36:10,682 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__n_estimators': 200, 'classifier__min_samples_split': 5, 'classifier__max_depth': 4, 'classifier__learning_rate': 0.05}
2025-09-16 17:36:10,683 - INFO - F1 Score: 0.6420, ROC AUC: 0.9240
2025-09-16 17:36:10,683 - INFO - GradientBoosting - Best F1 Score: 0.6324, Test F1 Score: 0.6420
2025-09-16 17:36:10,692 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
LightGBM          0.873003  0.570039  0.767016  0.654018  0.918252  0.674092
RandomForest      0.875051  0.577778  0.748691  0.652223  0.917592  0.670964
XGBoost           0.896354  0.698462  0.594241   0.64215  0.923945   0.63805
GradientBoosting  0.896764  0.701863  0.591623  0.642045  0.923969  0.632427
2025-09-16 17:36:10,693 - INFO - 
Best model: LightGBM
2025-09-16 17:36:10,705 - INFO - Accuracy: 0.8730
2025-09-16 17:36:10,707 - INFO - Precision: 0.5700
2025-09-16 17:36:10,709 - INFO - Recall: 0.7670
2025-09-16 17:36:10,711 - INFO - F1 Score: 0.6540
2025-09-16 17:36:10,713 - INFO - ROC AUC: 0.9183
2025-09-16 17:36:10,718 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.95      0.89      0.92      2059
           1       0.57      0.77      0.65       382

    accuracy                           0.87      2441
   macro avg       0.76      0.83      0.79      2441
weighted avg       0.89      0.87      0.88      2441

2025-09-16 17:36:10,756 - INFO - 
Overfitting Check:
2025-09-16 17:36:10,760 - INFO - Train F1 Score: 0.7317
2025-09-16 17:36:10,762 - INFO - Test F1 Score: 0.6540
2025-09-16 17:36:10,766 - INFO - Train ROC AUC: 0.9511
2025-09-16 17:36:10,767 - INFO - Test ROC AUC: 0.9183
2025-09-16 17:36:10,776 - INFO - Best model saved to models\best_model.pkl
2025-09-16 17:36:10,776 - INFO - Generating evaluation plots (model metrics)
2025-09-16 17:36:10,912 - INFO - Generating feature importance plot
2025-09-16 17:36:10,925 - ERROR - Failed to generate evaluation plots: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 358, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 17:36:10,928 - ERROR - Model training failed: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 311, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 358, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 17:36:10,929 - ERROR - Training failed: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 311, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 358, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 17:36:16,585 - INFO - Logger initialized
2025-09-16 17:36:16,628 - INFO - No GPU detected - using CPU only
2025-09-16 17:36:17,672 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:36:17,685 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:36:17,685 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:36:17,685 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:36:17,685 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:36:17,686 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:36:17,687 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:36:17,688 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:36:17,688 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:36:17,688 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:36:17,689 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:48:20,775 - INFO - Logger initialized
2025-09-16 17:48:20,816 - INFO - No GPU detected - using CPU only
2025-09-16 17:48:21,661 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:48:21,671 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:48:21,672 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:48:21,672 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:48:21,672 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:48:21,672 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:48:21,672 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:48:21,672 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:48:21,672 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:48:21,673 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:48:21,674 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:48:21,676 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:51:07,916 - INFO - Logger initialized
2025-09-16 17:51:07,951 - INFO - No GPU detected - using CPU only
2025-09-16 17:51:08,652 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:51:08,663 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:51:08,664 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:51:08,665 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:51:08,666 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:51:08,667 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:59:22,910 - INFO - Logger initialized
2025-09-16 17:59:22,979 - INFO - No GPU detected - using CPU only
2025-09-16 17:59:23,862 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:59:23,874 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:59:23,875 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:59:23,875 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:59:23,875 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:59:23,875 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:59:23,875 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:59:23,876 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:59:23,877 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:59:23,878 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:59:23,878 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:59:23,878 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:59:23,879 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 17:59:58,412 - INFO - Logger initialized
2025-09-16 17:59:58,451 - INFO - No GPU detected - using CPU only
2025-09-16 17:59:59,315 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 17:59:59,328 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 17:59:59,328 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 17:59:59,328 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 17:59:59,328 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 17:59:59,329 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 17:59:59,329 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 17:59:59,329 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 17:59:59,329 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 17:59:59,329 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 17:59:59,330 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 17:59:59,331 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 17:59:59,331 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 17:59:59,331 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 17:59:59,331 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 17:59:59,331 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 17:59:59,331 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 17:59:59,332 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 17:59:59,332 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 17:59:59,332 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 17:59:59,332 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 17:59:59,339 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 17:59:59,339 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 17:59:59,340 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 17:59:59,340 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 17:59:59,340 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 17:59:59,340 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 17:59:59,341 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:00:44,954 - INFO - POST /train
2025-09-16 18:00:44,954 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:00:44,955 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:00:44,955 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:00:44,955 - INFO - Starting data preprocessing
2025-09-16 18:00:44,956 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:00:44,957 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:00:44,976 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:00:44,983 - INFO - Removing 125 duplicate rows
2025-09-16 18:00:44,989 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:00:45,050 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:00:45,050 - INFO - Converting boolean columns to integers
2025-09-16 18:00:45,056 - INFO - Applying target encoding for Month
2025-09-16 18:00:45,064 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:00:45,132 - INFO - Creating interaction features
2025-09-16 18:00:45,139 - INFO - Transforming skewed features
2025-09-16 18:00:45,176 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:00:45,176 - INFO - Scaling features
2025-09-16 18:00:45,185 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:00:45,186 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:00:45,194 - INFO - PCA reduced features to: 15 components
2025-09-16 18:00:45,196 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:00:45,196 - INFO - Applying K-Means clustering
2025-09-16 18:00:56,931 - INFO - Optimal number of clusters: 3
2025-09-16 18:00:56,995 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:00:56,995 - INFO - Combining PCA features with cluster labels
2025-09-16 18:00:56,995 - INFO - Saving preprocessed data
2025-09-16 18:00:57,247 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:00:57,247 - INFO - Data preprocessing completed successfully
2025-09-16 18:00:57,249 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:00:57,249 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:00:57,294 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 18:00:57,298 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 18:00:57,306 - INFO - Using 50.0% of data (4882 samples) for hyperparameter tuning
2025-09-16 18:00:57,306 - INFO - 
Training and tuning XGBoost...
2025-09-16 18:00:57,308 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 18:01:04,092 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__n_estimators': 100, 'classifier__max_depth': 5, 'classifier__learning_rate': 0.05, 'classifier__gamma': 0.2, 'classifier__colsample_bytree': 0.8}
2025-09-16 18:01:04,092 - INFO - F1 Score: 0.6464, ROC AUC: 0.9251
2025-09-16 18:01:04,093 - INFO - XGBoost - Best F1 Score: 0.6211, Test F1 Score: 0.6464
2025-09-16 18:01:04,093 - INFO - 
Training and tuning LightGBM...
2025-09-16 18:01:04,095 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 18:01:10,099 - INFO - Best parameters: {'classifier__subsample': 0.8, 'classifier__num_leaves': 70, 'classifier__n_estimators': 200, 'classifier__max_depth': 3, 'classifier__learning_rate': 0.05, 'classifier__colsample_bytree': 0.9}
2025-09-16 18:01:10,099 - INFO - F1 Score: 0.6504, ROC AUC: 0.9181
2025-09-16 18:01:10,100 - INFO - LightGBM - Best F1 Score: 0.6704, Test F1 Score: 0.6504
2025-09-16 18:01:10,100 - INFO - 
Training and tuning RandomForest...
2025-09-16 18:01:10,101 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 18:01:45,934 - INFO - Best parameters: {'classifier__n_estimators': 200, 'classifier__min_samples_split': 5, 'classifier__min_samples_leaf': 2, 'classifier__max_features': 0.7, 'classifier__max_depth': 5, 'classifier__bootstrap': True}
2025-09-16 18:01:45,935 - INFO - F1 Score: 0.6406, ROC AUC: 0.9173
2025-09-16 18:01:45,935 - INFO - RandomForest - Best F1 Score: 0.6737, Test F1 Score: 0.6406
2025-09-16 18:01:45,935 - INFO - 
Training and tuning GradientBoosting...
2025-09-16 18:01:45,937 - INFO - Using Randomized Search for hyperparameter tuning
2025-09-16 18:01:54,195 - ERROR - Model training failed: 
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 243, in train_model
    features = X_test.columns
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py", line 874, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py", line 1768, in _run_search
    evaluate_candidates(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py", line 821, in evaluate_candidates
    out = parallel(
          ^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\parallel.py", line 63, in __call__
    return super().__call__(iterable_with_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\parallel.py", line 1098, in __call__
    self.retrieve()
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\parallel.py", line 975, in retrieve
    self._output.extend(job.get(timeout=self.timeout))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\joblib\_parallel_backends.py", line 567, in wrap_future_result
    return future.result(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
joblib.my_exceptions.WorkerInterrupt
2025-09-16 18:03:32,553 - INFO - Logger initialized
2025-09-16 18:04:02,780 - INFO - Logger initialized
2025-09-16 18:04:02,823 - INFO - No GPU detected - using CPU only
2025-09-16 18:04:03,790 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:04:03,802 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:04:03,802 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:04:03,802 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:04:03,803 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:04:03,803 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:04:03,803 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:04:03,803 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:04:03,803 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:04:03,803 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:04:03,804 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:04:03,805 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:04:03,806 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:04:06,347 - INFO - Logger initialized
2025-09-16 18:04:06,381 - INFO - No GPU detected - using CPU only
2025-09-16 18:04:07,188 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:04:07,199 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:04:07,200 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:04:07,200 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:04:07,200 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:04:07,200 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:04:07,200 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:04:07,201 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:04:07,201 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:04:07,201 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:04:07,201 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:04:07,201 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:04:07,201 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:04:07,202 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:04:07,203 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:04:07,203 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:04:07,203 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:04:07,203 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:04:07,203 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:04:07,204 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:04:16,068 - INFO - GET /train → train.html
2025-09-16 18:04:17,742 - INFO - POST /train
2025-09-16 18:04:17,742 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:04:17,743 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:04:17,743 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:04:17,744 - INFO - Starting data preprocessing
2025-09-16 18:04:17,745 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:04:17,745 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:04:17,764 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:04:17,770 - INFO - Removing 125 duplicate rows
2025-09-16 18:04:17,776 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:04:17,837 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:04:17,837 - INFO - Converting boolean columns to integers
2025-09-16 18:04:17,843 - INFO - Applying target encoding for Month
2025-09-16 18:04:17,848 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:04:17,850 - INFO - Creating interaction features
2025-09-16 18:04:17,924 - INFO - Transforming skewed features
2025-09-16 18:04:17,956 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:04:17,957 - INFO - Scaling features
2025-09-16 18:04:17,966 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:04:17,966 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:04:17,975 - INFO - PCA reduced features to: 15 components
2025-09-16 18:04:17,976 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:04:17,977 - INFO - Applying K-Means clustering
2025-09-16 18:04:29,369 - INFO - Optimal number of clusters: 3
2025-09-16 18:04:29,435 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:04:29,435 - INFO - Combining PCA features with cluster labels
2025-09-16 18:04:29,436 - INFO - Saving preprocessed data
2025-09-16 18:04:29,688 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:04:29,688 - INFO - Data preprocessing completed successfully
2025-09-16 18:04:29,690 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:04:29,690 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:04:29,734 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 18:04:29,738 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 18:04:29,738 - ERROR - Model training failed: name 'train_test_split' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 174, in train_model
    X_tune, _, y_tune, _ = train_test_split(
                           ^^^^^^^^^^^^^^^^
NameError: name 'train_test_split' is not defined
2025-09-16 18:04:29,740 - ERROR - Training failed: name 'train_test_split' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 174, in train_model
    X_tune, _, y_tune, _ = train_test_split(
                           ^^^^^^^^^^^^^^^^
NameError: name 'train_test_split' is not defined
2025-09-16 18:05:54,466 - INFO - Logger initialized
2025-09-16 18:05:54,499 - INFO - No GPU detected - using CPU only
2025-09-16 18:05:55,241 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:05:55,252 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:05:55,252 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:05:55,252 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:05:55,252 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:05:55,252 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:05:55,253 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:05:55,253 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:05:55,253 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:05:55,253 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:05:55,253 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:05:55,254 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:05:55,255 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:05:55,255 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:05:55,255 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:05:55,255 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:05:55,255 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:05:55,255 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:05:55,255 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:05:55,257 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:06:08,115 - INFO - GET /train → train.html
2025-09-16 18:06:09,137 - INFO - POST /train
2025-09-16 18:06:09,137 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:06:09,139 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:06:09,139 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:06:09,139 - INFO - Starting data preprocessing
2025-09-16 18:06:09,141 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:06:09,141 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:06:09,159 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:06:09,166 - INFO - Removing 125 duplicate rows
2025-09-16 18:06:09,172 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:06:09,234 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:06:09,234 - INFO - Converting boolean columns to integers
2025-09-16 18:06:09,240 - INFO - Applying target encoding for Month
2025-09-16 18:06:09,245 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:06:09,246 - INFO - Creating interaction features
2025-09-16 18:06:09,320 - INFO - Transforming skewed features
2025-09-16 18:06:09,357 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:06:09,357 - INFO - Scaling features
2025-09-16 18:06:09,365 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:06:09,366 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:06:09,375 - INFO - PCA reduced features to: 15 components
2025-09-16 18:06:09,376 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:06:09,377 - INFO - Applying K-Means clustering
2025-09-16 18:06:20,435 - INFO - Optimal number of clusters: 3
2025-09-16 18:06:20,538 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:06:20,539 - INFO - Combining PCA features with cluster labels
2025-09-16 18:06:20,539 - INFO - Saving preprocessed data
2025-09-16 18:06:20,762 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:06:20,762 - INFO - Data preprocessing completed successfully
2025-09-16 18:06:20,764 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:06:20,764 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:06:20,806 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 18:06:20,810 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 18:06:20,811 - ERROR - Model training failed: name 'train_test_split' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 174, in train_model
    from sklearn.utils import resample
                           ^^^^^^^^^^^^
NameError: name 'train_test_split' is not defined
2025-09-16 18:06:20,825 - ERROR - Training failed: name 'train_test_split' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 174, in train_model
    from sklearn.utils import resample
                           ^^^^^^^^^^^^
NameError: name 'train_test_split' is not defined
2025-09-16 18:06:43,172 - INFO - Logger initialized
2025-09-16 18:06:43,203 - INFO - No GPU detected - using CPU only
2025-09-16 18:06:43,974 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:06:43,984 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:06:43,985 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:06:43,985 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:06:43,985 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:06:43,985 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:06:43,985 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:06:43,985 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:06:43,985 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:06:43,986 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:06:43,987 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:06:43,987 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:06:43,987 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:06:43,987 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:06:43,987 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:06:43,987 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:06:43,987 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:06:43,988 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:06:43,988 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:06:43,989 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:06:54,023 - INFO - Logger initialized
2025-09-16 18:06:54,056 - INFO - No GPU detected - using CPU only
2025-09-16 18:06:54,753 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:06:54,763 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:06:54,763 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:06:54,763 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:06:54,763 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:06:54,763 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:06:54,763 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:06:54,764 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:06:54,765 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:06:54,766 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:06:54,766 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:06:54,766 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:06:54,768 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:06:57,389 - INFO - Logger initialized
2025-09-16 18:06:57,421 - INFO - No GPU detected - using CPU only
2025-09-16 18:06:58,129 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:06:58,139 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:06:58,139 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:06:58,140 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:06:58,140 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:06:58,140 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:06:58,140 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:06:58,140 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:06:58,140 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:06:58,141 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:06:58,142 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:06:58,143 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:06:58,144 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:06:58,595 - INFO - GET /train → train.html
2025-09-16 18:07:00,053 - INFO - POST /train
2025-09-16 18:07:00,053 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:07:00,054 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:07:00,054 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:07:00,054 - INFO - Starting data preprocessing
2025-09-16 18:07:00,056 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:07:00,057 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:07:00,075 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:07:00,082 - INFO - Removing 125 duplicate rows
2025-09-16 18:07:00,087 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:07:00,147 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:07:00,147 - INFO - Converting boolean columns to integers
2025-09-16 18:07:00,154 - INFO - Applying target encoding for Month
2025-09-16 18:07:00,158 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:07:00,160 - INFO - Creating interaction features
2025-09-16 18:07:00,237 - INFO - Transforming skewed features
2025-09-16 18:07:00,270 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:07:00,271 - INFO - Scaling features
2025-09-16 18:07:00,279 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:07:00,279 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:07:00,287 - INFO - PCA reduced features to: 15 components
2025-09-16 18:07:00,288 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:07:00,289 - INFO - Applying K-Means clustering
2025-09-16 18:07:11,359 - INFO - Optimal number of clusters: 3
2025-09-16 18:07:11,419 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:07:11,420 - INFO - Combining PCA features with cluster labels
2025-09-16 18:07:11,420 - INFO - Saving preprocessed data
2025-09-16 18:07:11,672 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:07:11,673 - INFO - Data preprocessing completed successfully
2025-09-16 18:07:11,674 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:07:11,674 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:07:11,715 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 18:07:11,721 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 18:07:17,704 - INFO - XGBoost - Best F1 Score: 0.6211, Test F1 Score: 0.6464
2025-09-16 18:07:23,404 - INFO - LightGBM - Best F1 Score: 0.6704, Test F1 Score: 0.6504
2025-09-16 18:07:56,044 - INFO - RandomForest - Best F1 Score: 0.6737, Test F1 Score: 0.6406
2025-09-16 18:08:26,277 - INFO - GradientBoosting - Best F1 Score: 0.6375, Test F1 Score: 0.6313
2025-09-16 18:08:26,292 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
LightGBM           0.86481  0.546263  0.803665  0.650424  0.918075  0.670386
XGBoost           0.900041  0.724026   0.58377  0.646377  0.925142  0.621137
RandomForest        0.8644   0.54731  0.772251  0.640608  0.917343  0.673726
GradientBoosting  0.894715  0.698413  0.575916  0.631277  0.923036  0.637472
2025-09-16 18:08:26,292 - INFO - 
Best model: LightGBM
2025-09-16 18:08:26,302 - INFO - Accuracy: 0.8648
2025-09-16 18:08:26,305 - INFO - Precision: 0.5463
2025-09-16 18:08:26,307 - INFO - Recall: 0.8037
2025-09-16 18:08:26,309 - INFO - F1 Score: 0.6504
2025-09-16 18:08:26,311 - INFO - ROC AUC: 0.9181
2025-09-16 18:08:26,317 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.96      0.88      0.92      2059
           1       0.55      0.80      0.65       382

    accuracy                           0.86      2441
   macro avg       0.75      0.84      0.78      2441
weighted avg       0.90      0.86      0.87      2441

2025-09-16 18:08:26,355 - INFO - 
Overfitting Check:
2025-09-16 18:08:26,360 - INFO - Train F1 Score: 0.6812
2025-09-16 18:08:26,364 - INFO - Test F1 Score: 0.6504
2025-09-16 18:08:26,368 - INFO - Train ROC AUC: 0.9352
2025-09-16 18:08:26,370 - INFO - Test ROC AUC: 0.9181
2025-09-16 18:08:26,379 - INFO - Best model saved to models\best_model.pkl
2025-09-16 18:08:26,380 - INFO - Generating evaluation plots (model metrics)
2025-09-16 18:08:26,579 - ERROR - Failed to generate evaluation plots: name 'json' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 336, in generate_evaluation_plots
    json.dump(fig_cm.to_dict(), f)
    ^^^^
NameError: name 'json' is not defined
2025-09-16 18:08:26,580 - ERROR - Model training failed: name 'json' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 312, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 336, in generate_evaluation_plots
    json.dump(fig_cm.to_dict(), f)
    ^^^^
NameError: name 'json' is not defined
2025-09-16 18:08:26,581 - ERROR - Training failed: name 'json' is not defined
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 312, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 336, in generate_evaluation_plots
    json.dump(fig_cm.to_dict(), f)
    ^^^^
NameError: name 'json' is not defined
2025-09-16 18:09:33,819 - INFO - Logger initialized
2025-09-16 18:09:33,851 - INFO - No GPU detected - using CPU only
2025-09-16 18:09:34,551 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:09:34,563 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:09:34,563 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:09:34,563 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:09:34,564 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:09:34,564 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:09:34,564 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:09:34,564 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:09:34,564 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:09:34,565 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:09:34,565 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:09:34,565 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:09:34,565 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:09:34,565 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:09:34,566 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:09:34,567 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:09:34,567 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:09:34,567 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:09:34,567 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:09:34,568 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:09:37,119 - INFO - Logger initialized
2025-09-16 18:09:37,150 - INFO - No GPU detected - using CPU only
2025-09-16 18:09:37,951 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:09:37,962 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:09:37,962 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:09:37,962 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:09:37,962 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:09:37,963 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:09:37,964 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:09:37,965 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:09:37,965 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:09:37,965 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:09:37,965 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:09:37,966 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:09:40,634 - INFO - GET /train → train.html
2025-09-16 18:09:42,022 - INFO - POST /train
2025-09-16 18:09:42,022 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:09:42,023 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:09:42,023 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:09:42,024 - INFO - Starting data preprocessing
2025-09-16 18:09:42,025 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:09:42,025 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:09:42,044 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:09:42,050 - INFO - Removing 125 duplicate rows
2025-09-16 18:09:42,055 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:09:42,118 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:09:42,119 - INFO - Converting boolean columns to integers
2025-09-16 18:09:42,125 - INFO - Applying target encoding for Month
2025-09-16 18:09:42,129 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:09:42,132 - INFO - Creating interaction features
2025-09-16 18:09:42,204 - INFO - Transforming skewed features
2025-09-16 18:09:42,237 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:09:42,237 - INFO - Scaling features
2025-09-16 18:09:42,246 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:09:42,247 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:09:42,254 - INFO - PCA reduced features to: 15 components
2025-09-16 18:09:42,257 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:09:42,257 - INFO - Applying K-Means clustering
2025-09-16 18:09:53,118 - INFO - Optimal number of clusters: 3
2025-09-16 18:09:53,178 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:09:53,178 - INFO - Combining PCA features with cluster labels
2025-09-16 18:09:53,179 - INFO - Saving preprocessed data
2025-09-16 18:09:53,451 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:09:53,451 - INFO - Data preprocessing completed successfully
2025-09-16 18:09:53,453 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:09:53,453 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:09:53,500 - INFO - Data loaded successfully. Shape: (12205, 18)
2025-09-16 18:09:53,504 - INFO - Training set: (9764, 16), Testing set: (2441, 16)
2025-09-16 18:09:58,945 - INFO - XGBoost - Best F1 Score: 0.6211, Test F1 Score: 0.6464
2025-09-16 18:10:03,282 - INFO - LightGBM - Best F1 Score: 0.6704, Test F1 Score: 0.6504
2025-09-16 18:10:38,879 - INFO - RandomForest - Best F1 Score: 0.6737, Test F1 Score: 0.6406
2025-09-16 18:11:09,856 - INFO - GradientBoosting - Best F1 Score: 0.6375, Test F1 Score: 0.6313
2025-09-16 18:11:09,860 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
LightGBM           0.86481  0.546263  0.803665  0.650424  0.918075  0.670386
XGBoost           0.900041  0.724026   0.58377  0.646377  0.925142  0.621137
RandomForest        0.8644   0.54731  0.772251  0.640608  0.917343  0.673726
GradientBoosting  0.894715  0.698413  0.575916  0.631277  0.923036  0.637472
2025-09-16 18:11:09,861 - INFO - 
Best model: LightGBM
2025-09-16 18:11:09,874 - INFO - Accuracy: 0.8648
2025-09-16 18:11:09,876 - INFO - Precision: 0.5463
2025-09-16 18:11:09,877 - INFO - Recall: 0.8037
2025-09-16 18:11:09,879 - INFO - F1 Score: 0.6504
2025-09-16 18:11:09,881 - INFO - ROC AUC: 0.9181
2025-09-16 18:11:09,887 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.96      0.88      0.92      2059
           1       0.55      0.80      0.65       382

    accuracy                           0.86      2441
   macro avg       0.75      0.84      0.78      2441
weighted avg       0.90      0.86      0.87      2441

2025-09-16 18:11:09,925 - INFO - 
Overfitting Check:
2025-09-16 18:11:09,928 - INFO - Train F1 Score: 0.6812
2025-09-16 18:11:09,930 - INFO - Test F1 Score: 0.6504
2025-09-16 18:11:09,934 - INFO - Train ROC AUC: 0.9352
2025-09-16 18:11:09,936 - INFO - Test ROC AUC: 0.9181
2025-09-16 18:11:09,942 - INFO - Best model saved to models\best_model.pkl
2025-09-16 18:11:09,942 - INFO - Generating evaluation plots (model metrics)
2025-09-16 18:11:10,042 - INFO - Generating feature importance plot
2025-09-16 18:11:10,056 - ERROR - Failed to generate evaluation plots: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 360, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 18:11:10,059 - ERROR - Model training failed: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 360, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 18:11:10,060 - ERROR - Training failed: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 360, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 18:12:19,618 - INFO - Logger initialized
2025-09-16 18:12:19,691 - INFO - No GPU detected - using CPU only
2025-09-16 18:12:20,456 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:12:20,465 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:12:20,465 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:12:20,466 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:12:20,466 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:12:20,466 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:12:20,466 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:12:20,466 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:12:20,466 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:12:20,467 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:12:20,467 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:12:20,467 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:12:20,467 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:12:20,467 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:12:20,467 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:12:20,468 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:12:20,469 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:12:20,469 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:12:20,470 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:13:09,841 - INFO - Logger initialized
2025-09-16 18:13:09,907 - INFO - No GPU detected - using CPU only
2025-09-16 18:13:11,672 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:13:11,686 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:13:11,686 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:13:11,686 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:13:11,687 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:13:11,687 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:13:11,687 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:13:11,687 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:13:11,687 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:13:11,687 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:13:11,688 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:13:11,688 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:13:11,688 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:13:11,688 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:13:11,688 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:13:11,689 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:13:11,689 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:13:11,689 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:13:11,689 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:13:11,689 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:13:11,689 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:13:11,690 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:13:11,690 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:13:11,690 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:13:11,690 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:13:11,690 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:13:11,690 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:13:11,692 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:13:21,286 - INFO - Logger initialized
2025-09-16 18:13:21,321 - INFO - No GPU detected - using CPU only
2025-09-16 18:13:22,045 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:13:22,056 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:13:22,056 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:13:22,056 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:13:22,056 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:13:22,056 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:13:22,057 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:13:22,057 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:13:22,057 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:13:22,057 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:13:22,057 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:13:22,057 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:13:22,058 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:13:22,058 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:13:22,058 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:13:22,058 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:13:22,058 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:13:22,059 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:13:22,059 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:13:22,060 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:13:22,060 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:13:22,061 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:13:22,061 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:13:22,061 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:13:22,061 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:13:22,062 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:13:22,062 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:13:22,063 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:14:16,199 - INFO - Logger initialized
2025-09-16 18:14:16,233 - INFO - No GPU detected - using CPU only
2025-09-16 18:14:16,942 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:14:16,952 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:14:16,952 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:14:16,952 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:14:16,952 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:14:16,953 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:14:16,953 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:14:16,953 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:14:16,953 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:14:16,953 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:14:16,953 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:14:16,953 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:14:16,954 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:14:16,955 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:14:16,955 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:14:16,955 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:14:16,955 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:14:16,955 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:14:16,955 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:14:16,956 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:35:24,255 - INFO - Logger initialized
2025-09-16 18:35:24,390 - INFO - No GPU detected - using CPU only
2025-09-16 18:35:25,200 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:35:25,210 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:35:25,210 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:35:25,211 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:35:25,211 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:35:25,211 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:35:25,211 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:35:25,211 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:35:25,211 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:35:25,211 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:35:25,212 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:35:25,212 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:35:25,212 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:35:25,212 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:35:25,212 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:35:25,213 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:35:25,213 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:35:25,213 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:35:25,213 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:35:25,214 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:35:25,214 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:35:25,214 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:35:25,214 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:35:25,214 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:35:25,214 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:35:25,215 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:35:25,215 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:35:25,216 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:35:40,610 - INFO - Logger initialized
2025-09-16 18:35:40,676 - INFO - No GPU detected - using CPU only
2025-09-16 18:35:41,395 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:35:41,404 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:35:41,404 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:35:41,404 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:35:41,405 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:35:41,405 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:35:41,405 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:35:41,405 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:35:41,405 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:35:41,406 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:35:41,406 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:35:41,406 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:35:41,406 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:35:41,406 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:35:41,406 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:35:41,406 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:35:41,407 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:35:41,408 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:35:41,408 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:35:41,409 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:35:44,127 - INFO - Logger initialized
2025-09-16 18:35:44,195 - INFO - No GPU detected - using CPU only
2025-09-16 18:35:44,959 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:35:44,970 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:35:44,970 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:35:44,970 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:35:44,970 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:35:44,970 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:35:44,970 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:35:44,970 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:35:44,970 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:35:44,972 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:35:44,973 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:35:44,974 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:35:44,974 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:35:44,975 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:35:51,112 - INFO - GET /train → train.html
2025-09-16 18:35:52,094 - INFO - POST /train
2025-09-16 18:35:52,095 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:35:52,096 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:35:52,096 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:35:52,097 - INFO - Starting data preprocessing
2025-09-16 18:35:52,098 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:35:52,098 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:35:52,119 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:35:52,126 - INFO - Removing 125 duplicate rows
2025-09-16 18:35:52,131 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:35:52,131 - INFO - Converting boolean columns to integers
2025-09-16 18:35:52,131 - INFO - Creating interaction features
2025-09-16 18:35:52,134 - INFO - Applying target encoding for Month
2025-09-16 18:35:52,135 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:35:52,137 - INFO - Transforming skewed features
2025-09-16 18:35:52,172 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 18:35:52,292 - INFO - Scaling features
2025-09-16 18:35:52,309 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:35:52,324 - INFO - PCA reduced features to: 15 components
2025-09-16 18:35:52,325 - INFO - Applying K-Means clustering
2025-09-16 18:36:15,835 - INFO - Optimal number of clusters: 3
2025-09-16 18:36:15,953 - INFO - Combining PCA features with cluster labels
2025-09-16 18:36:15,954 - INFO - Saving preprocessed data
2025-09-16 18:36:16,362 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:36:16,364 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:36:16,365 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:36:16,367 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:36:16,369 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:36:16,506 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:36:16,507 - INFO - Data preprocessing completed successfully
2025-09-16 18:36:16,510 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:36:16,510 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:36:16,577 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 18:36:16,584 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 18:36:30,149 - INFO - XGBoost - Best F1 Score: 0.8888, Test F1 Score: 0.8834
2025-09-16 18:37:01,776 - INFO - LightGBM - Best F1 Score: 0.8893, Test F1 Score: 0.8846
2025-09-16 18:38:08,926 - INFO - RandomForest - Best F1 Score: 0.8893, Test F1 Score: 0.8881
2025-09-16 18:39:11,792 - INFO - GradientBoosting - Best F1 Score: 0.8868, Test F1 Score: 0.8844
2025-09-16 18:39:11,802 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
RandomForest      0.887109  0.880248  0.896066  0.888087  0.952936  0.889325
LightGBM          0.883467  0.876131  0.893152   0.88456  0.950258   0.88931
GradientBoosting  0.883952  0.880964   0.88781  0.884373  0.950352  0.886778
XGBoost           0.882739  0.878119  0.888781  0.883418  0.952075  0.888787
2025-09-16 18:39:11,803 - INFO - 
Best model: RandomForest
2025-09-16 18:39:11,897 - INFO - Accuracy: 0.8871
2025-09-16 18:39:11,899 - INFO - Precision: 0.8802
2025-09-16 18:39:11,901 - INFO - Recall: 0.8961
2025-09-16 18:39:11,905 - INFO - F1 Score: 0.8881
2025-09-16 18:39:11,906 - INFO - ROC AUC: 0.9529
2025-09-16 18:39:11,913 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.89      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 18:39:12,072 - INFO - 
Overfitting Check:
2025-09-16 18:39:12,078 - INFO - Train F1 Score: 0.9498
2025-09-16 18:39:12,080 - INFO - Test F1 Score: 0.8881
2025-09-16 18:39:12,082 - INFO - Train ROC AUC: 0.9900
2025-09-16 18:39:12,084 - INFO - Test ROC AUC: 0.9529
2025-09-16 18:39:12,248 - INFO - Best model saved to models\best_model.pkl
2025-09-16 18:39:12,248 - INFO - Generating evaluation plots (model metrics)
2025-09-16 18:39:12,440 - INFO - Generating feature importance plot
2025-09-16 18:39:12,472 - ERROR - Failed to generate evaluation plots: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 360, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 18:39:12,476 - ERROR - Model training failed: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 360, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 18:39:12,477 - ERROR - Training failed: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 360, in generate_evaluation_plots
    json.dump(fig_fi.to_dict(), f)
  File "C:\Users\drsnc\anaconda3\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
2025-09-16 18:39:18,242 - INFO - Logger initialized
2025-09-16 18:39:18,340 - INFO - No GPU detected - using CPU only
2025-09-16 18:39:19,435 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:39:19,448 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:39:19,448 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:39:19,448 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:39:19,448 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:39:19,449 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:39:19,449 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:39:19,449 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:39:19,449 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:39:19,449 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:39:19,449 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:39:19,449 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:39:19,450 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:39:19,451 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:39:19,451 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:39:19,451 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:39:19,451 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:39:19,451 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:39:19,451 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:39:19,452 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:48:20,760 - INFO - Logger initialized
2025-09-16 18:48:20,827 - INFO - No GPU detected - using CPU only
2025-09-16 18:48:21,565 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:48:21,576 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:48:21,576 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:48:21,576 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:48:21,576 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:48:21,577 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:48:21,578 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:48:21,579 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:48:21,579 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:48:21,579 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:48:21,579 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:48:21,580 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:48:31,627 - INFO - Logger initialized
2025-09-16 18:48:31,694 - INFO - No GPU detected - using CPU only
2025-09-16 18:48:32,403 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:48:32,431 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:48:32,432 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:48:32,433 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:48:32,435 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:48:32,435 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:48:32,436 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:48:32,437 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:48:32,437 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:48:32,440 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:48:32,441 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:48:32,443 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:48:32,447 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:48:32,451 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:48:32,452 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:48:32,453 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:48:32,455 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:48:32,457 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:48:32,458 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:48:32,458 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:48:32,458 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:48:32,459 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:48:32,459 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:48:32,459 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:48:32,460 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:48:32,460 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:48:32,461 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:48:32,463 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:48:35,041 - INFO - Logger initialized
2025-09-16 18:48:35,104 - INFO - No GPU detected - using CPU only
2025-09-16 18:48:35,813 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 18:48:35,824 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 18:48:35,824 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 18:48:35,824 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 18:48:35,824 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 18:48:35,825 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 18:48:35,825 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 18:48:35,825 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 18:48:35,825 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 18:48:35,825 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 18:48:35,826 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 18:48:35,827 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 18:48:35,830 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 18:49:04,217 - INFO - POST /train
2025-09-16 18:49:04,219 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:49:04,220 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:49:04,220 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:49:04,221 - INFO - Starting data preprocessing
2025-09-16 18:49:04,222 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:49:04,222 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:49:04,244 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:49:04,249 - INFO - Removing 125 duplicate rows
2025-09-16 18:49:04,257 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:49:04,258 - INFO - Converting boolean columns to integers
2025-09-16 18:49:04,259 - INFO - Creating interaction features
2025-09-16 18:49:04,262 - INFO - Applying target encoding for Month
2025-09-16 18:49:04,267 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:49:04,269 - INFO - Transforming skewed features
2025-09-16 18:49:04,307 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 18:49:04,422 - INFO - Scaling features
2025-09-16 18:49:04,434 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:49:04,451 - INFO - PCA reduced features to: 15 components
2025-09-16 18:49:04,451 - INFO - Applying K-Means clustering
2025-09-16 18:49:26,906 - INFO - Optimal number of clusters: 3
2025-09-16 18:49:27,012 - INFO - Combining PCA features with cluster labels
2025-09-16 18:49:27,013 - INFO - Saving preprocessed data
2025-09-16 18:49:27,432 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:49:27,434 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:49:27,435 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:49:27,437 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:49:27,439 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:49:27,579 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:49:27,580 - INFO - Data preprocessing completed successfully
2025-09-16 18:49:27,583 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:49:27,583 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:49:27,654 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 18:49:27,660 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 18:49:34,221 - INFO - XGBoost - Best F1 Score: 0.8888, Test F1 Score: 0.8834
2025-09-16 18:49:39,885 - INFO - LightGBM - Best F1 Score: 0.8893, Test F1 Score: 0.8846
2025-09-16 18:50:44,064 - INFO - RandomForest - Best F1 Score: 0.8893, Test F1 Score: 0.8881
2025-09-16 18:51:42,368 - INFO - GradientBoosting - Best F1 Score: 0.8868, Test F1 Score: 0.8844
2025-09-16 18:51:42,377 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
RandomForest      0.887109  0.880248  0.896066  0.888087  0.952936  0.889325
LightGBM          0.883467  0.876131  0.893152   0.88456  0.950258   0.88931
GradientBoosting  0.883952  0.880964   0.88781  0.884373  0.950352  0.886778
XGBoost           0.882739  0.878119  0.888781  0.883418  0.952075  0.888787
2025-09-16 18:51:42,377 - INFO - 
Best model: RandomForest
2025-09-16 18:51:42,469 - INFO - Accuracy: 0.8871
2025-09-16 18:51:42,471 - INFO - Precision: 0.8802
2025-09-16 18:51:42,473 - INFO - Recall: 0.8961
2025-09-16 18:51:42,475 - INFO - F1 Score: 0.8881
2025-09-16 18:51:42,477 - INFO - ROC AUC: 0.9529
2025-09-16 18:51:42,483 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.89      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 18:51:42,653 - INFO - 
Overfitting Check:
2025-09-16 18:51:42,660 - INFO - Train F1 Score: 0.9498
2025-09-16 18:51:42,662 - INFO - Test F1 Score: 0.8881
2025-09-16 18:51:42,665 - INFO - Train ROC AUC: 0.9900
2025-09-16 18:51:42,667 - INFO - Test ROC AUC: 0.9529
2025-09-16 18:51:42,738 - INFO - Best model saved to models\best_model.pkl
2025-09-16 18:51:42,739 - INFO - Generating evaluation plots (model metrics)
2025-09-16 18:51:42,813 - ERROR - Failed to generate evaluation plots: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 18:51:42,814 - ERROR - Model training failed: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 18:51:42,814 - ERROR - Training failed: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 18:54:36,264 - INFO - GET /home → home.html
2025-09-16 18:58:12,889 - INFO - GET /train → train.html
2025-09-16 18:58:14,955 - INFO - POST /train
2025-09-16 18:58:14,955 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 18:58:14,960 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:58:14,960 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 18:58:14,960 - INFO - Starting data preprocessing
2025-09-16 18:58:14,961 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 18:58:14,962 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 18:58:14,984 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 18:58:14,989 - INFO - Removing 125 duplicate rows
2025-09-16 18:58:14,995 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 18:58:14,995 - INFO - Converting boolean columns to integers
2025-09-16 18:58:14,996 - INFO - Creating interaction features
2025-09-16 18:58:15,000 - INFO - Applying target encoding for Month
2025-09-16 18:58:15,002 - INFO - Applying frequency encoding for VisitorType
2025-09-16 18:58:15,004 - INFO - Transforming skewed features
2025-09-16 18:58:15,040 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 18:58:15,075 - INFO - Scaling features
2025-09-16 18:58:15,086 - INFO - Applying PCA for dimensionality reduction
2025-09-16 18:58:15,099 - INFO - PCA reduced features to: 15 components
2025-09-16 18:58:15,100 - INFO - Applying K-Means clustering
2025-09-16 18:58:38,743 - INFO - Optimal number of clusters: 3
2025-09-16 18:58:38,838 - INFO - Combining PCA features with cluster labels
2025-09-16 18:58:38,839 - INFO - Saving preprocessed data
2025-09-16 18:58:39,237 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 18:58:39,239 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 18:58:39,241 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 18:58:39,242 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 18:58:39,243 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 18:58:39,412 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 18:58:39,412 - INFO - Data preprocessing completed successfully
2025-09-16 18:58:39,415 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 18:58:39,416 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 18:58:39,479 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 18:58:39,485 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 18:58:45,814 - INFO - XGBoost - Best F1 Score: 0.8888, Test F1 Score: 0.8834
2025-09-16 18:58:51,893 - INFO - LightGBM - Best F1 Score: 0.8893, Test F1 Score: 0.8846
2025-09-16 19:00:00,459 - INFO - RandomForest - Best F1 Score: 0.8893, Test F1 Score: 0.8881
2025-09-16 19:01:03,687 - INFO - GradientBoosting - Best F1 Score: 0.8868, Test F1 Score: 0.8844
2025-09-16 19:01:03,689 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
RandomForest      0.887109  0.880248  0.896066  0.888087  0.952936  0.889325
LightGBM          0.883467  0.876131  0.893152   0.88456  0.950258   0.88931
GradientBoosting  0.883952  0.880964   0.88781  0.884373  0.950352  0.886778
XGBoost           0.882739  0.878119  0.888781  0.883418  0.952075  0.888787
2025-09-16 19:01:03,690 - INFO - 
Best model: RandomForest
2025-09-16 19:01:03,774 - INFO - Accuracy: 0.8871
2025-09-16 19:01:03,776 - INFO - Precision: 0.8802
2025-09-16 19:01:03,779 - INFO - Recall: 0.8961
2025-09-16 19:01:03,780 - INFO - F1 Score: 0.8881
2025-09-16 19:01:03,782 - INFO - ROC AUC: 0.9529
2025-09-16 19:01:03,788 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.89      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 19:01:03,960 - INFO - 
Overfitting Check:
2025-09-16 19:01:03,964 - INFO - Train F1 Score: 0.9498
2025-09-16 19:01:03,967 - INFO - Test F1 Score: 0.8881
2025-09-16 19:01:03,971 - INFO - Train ROC AUC: 0.9900
2025-09-16 19:01:03,972 - INFO - Test ROC AUC: 0.9529
2025-09-16 19:01:04,039 - INFO - Best model saved to models\best_model.pkl
2025-09-16 19:01:04,039 - INFO - Generating evaluation plots (model metrics)
2025-09-16 19:01:04,045 - ERROR - Failed to generate evaluation plots: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 19:01:04,046 - ERROR - Model training failed: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 19:01:04,047 - ERROR - Training failed: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 30, in train
    train_model()
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 19:03:17,200 - INFO - GET /train → train.html
2025-09-16 19:03:21,394 - INFO - POST /train
2025-09-16 19:03:21,394 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 19:03:21,396 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:03:21,397 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 19:03:21,397 - INFO - Starting data preprocessing
2025-09-16 19:03:21,398 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:03:21,398 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 19:03:21,420 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 19:03:21,426 - INFO - Removing 125 duplicate rows
2025-09-16 19:03:21,431 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 19:03:21,432 - INFO - Converting boolean columns to integers
2025-09-16 19:03:21,432 - INFO - Creating interaction features
2025-09-16 19:03:21,435 - INFO - Applying target encoding for Month
2025-09-16 19:03:21,437 - INFO - Applying frequency encoding for VisitorType
2025-09-16 19:03:21,439 - INFO - Transforming skewed features
2025-09-16 19:03:21,474 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 19:03:21,510 - INFO - Scaling features
2025-09-16 19:03:21,524 - INFO - Applying PCA for dimensionality reduction
2025-09-16 19:03:21,538 - INFO - PCA reduced features to: 15 components
2025-09-16 19:03:21,540 - INFO - Applying K-Means clustering
2025-09-16 19:03:48,457 - INFO - Optimal number of clusters: 3
2025-09-16 19:03:48,565 - INFO - Combining PCA features with cluster labels
2025-09-16 19:03:48,566 - INFO - Saving preprocessed data
2025-09-16 19:03:49,002 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 19:03:49,004 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 19:03:49,005 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 19:03:49,007 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 19:03:49,010 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 19:03:49,157 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 19:03:49,157 - INFO - Data preprocessing completed successfully
2025-09-16 19:03:49,162 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 19:03:49,162 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 19:03:49,253 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 19:03:49,271 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 19:05:19,917 - INFO - Logger initialized
2025-09-16 19:05:20,031 - INFO - No GPU detected - using CPU only
2025-09-16 19:05:44,054 - INFO - Logger initialized
2025-09-16 19:05:44,117 - INFO - No GPU detected - using CPU only
2025-09-16 19:05:45,335 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 19:05:45,347 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 19:05:45,347 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 19:05:45,347 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 19:05:45,347 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 19:05:45,347 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 19:05:45,347 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 19:05:45,348 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 19:05:45,349 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 19:05:45,349 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 19:05:45,349 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 19:05:45,349 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 19:05:45,349 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 19:05:45,350 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 19:05:45,350 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 19:05:45,350 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 19:05:45,350 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 19:05:45,350 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 19:05:45,351 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 19:05:45,352 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 19:06:18,080 - INFO - Logger initialized
2025-09-16 19:06:18,147 - INFO - No GPU detected - using CPU only
2025-09-16 19:06:18,908 - INFO - Initializing Dash app at /eda/ (all EDA plots, 2-column layout, simpler plots first)
2025-09-16 19:06:18,918 - WARNING - EDA plot file revenue_distribution.json not found
2025-09-16 19:06:18,918 - WARNING - EDA plot file visitor_type_pie.json not found
2025-09-16 19:06:18,918 - WARNING - EDA plot file visitor_vs_revenue.json not found
2025-09-16 19:06:18,919 - WARNING - EDA plot file operatingsystems_vs_revenue.json not found
2025-09-16 19:06:18,919 - WARNING - EDA plot file browser_vs_revenue.json not found
2025-09-16 19:06:18,919 - WARNING - EDA plot file region_vs_revenue.json not found
2025-09-16 19:06:18,919 - WARNING - EDA plot file traffictype_vs_revenue.json not found
2025-09-16 19:06:18,919 - WARNING - EDA plot file weekend_vs_revenue.json not found
2025-09-16 19:06:18,919 - WARNING - EDA plot file month_vs_revenue.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file correlation_heatmap.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file bounce_vs_exit.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file pca_scatter.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file administrative_histogram.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file administrative_duration_histogram.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file informational_histogram.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file informational_duration_histogram.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file productrelated_histogram.json not found
2025-09-16 19:06:18,920 - WARNING - EDA plot file productrelated_duration_histogram.json not found
2025-09-16 19:06:18,922 - WARNING - EDA plot file bouncerates_histogram.json not found
2025-09-16 19:06:18,922 - WARNING - EDA plot file exitrates_histogram.json not found
2025-09-16 19:06:18,922 - WARNING - EDA plot file pagevalues_histogram.json not found
2025-09-16 19:06:18,922 - WARNING - EDA plot file specialday_histogram.json not found
2025-09-16 19:06:18,922 - WARNING - EDA plot file operatingsystems_histogram.json not found
2025-09-16 19:06:18,922 - WARNING - EDA plot file browser_histogram.json not found
2025-09-16 19:06:18,923 - WARNING - EDA plot file region_histogram.json not found
2025-09-16 19:06:18,923 - WARNING - EDA plot file traffictype_histogram.json not found
2025-09-16 19:06:18,924 - INFO - Dash app layout set up for all EDA plots in 2-column layout
2025-09-16 19:06:39,388 - INFO - GET /train → train.html
2025-09-16 19:06:39,714 - INFO - GET /logs
2025-09-16 19:06:44,529 - INFO - POST /train
2025-09-16 19:06:44,530 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 19:06:44,531 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:06:44,531 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 19:06:44,531 - INFO - Starting data preprocessing
2025-09-16 19:06:44,533 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:06:44,533 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 19:06:44,554 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 19:06:44,565 - INFO - Removing 125 duplicate rows
2025-09-16 19:06:44,571 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 19:06:44,571 - INFO - Converting boolean columns to integers
2025-09-16 19:06:44,572 - INFO - Creating interaction features
2025-09-16 19:06:44,574 - INFO - Applying target encoding for Month
2025-09-16 19:06:44,579 - INFO - Applying frequency encoding for VisitorType
2025-09-16 19:06:44,581 - INFO - Transforming skewed features
2025-09-16 19:06:44,616 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 19:06:44,733 - INFO - Scaling features
2025-09-16 19:06:44,745 - INFO - Applying PCA for dimensionality reduction
2025-09-16 19:06:44,765 - INFO - PCA reduced features to: 15 components
2025-09-16 19:06:44,765 - INFO - Applying K-Means clustering
2025-09-16 19:06:45,853 - INFO - GET /logs
2025-09-16 19:06:46,871 - INFO - GET /logs
2025-09-16 19:06:47,853 - INFO - GET /logs
2025-09-16 19:06:48,844 - INFO - GET /logs
2025-09-16 19:06:49,850 - INFO - GET /logs
2025-09-16 19:06:50,865 - INFO - GET /logs
2025-09-16 19:06:51,845 - INFO - GET /logs
2025-09-16 19:06:52,840 - INFO - GET /logs
2025-09-16 19:06:53,857 - INFO - GET /logs
2025-09-16 19:06:55,474 - INFO - GET /logs
2025-09-16 19:06:56,298 - INFO - GET /logs
2025-09-16 19:06:57,302 - INFO - GET /logs
2025-09-16 19:06:58,518 - INFO - GET /logs
2025-09-16 19:06:59,302 - INFO - GET /logs
2025-09-16 19:07:00,294 - INFO - GET /logs
2025-09-16 19:07:01,619 - INFO - GET /logs
2025-09-16 19:07:02,354 - INFO - GET /logs
2025-09-16 19:07:03,333 - INFO - GET /logs
2025-09-16 19:07:03,846 - INFO - GET /logs
2025-09-16 19:07:04,846 - INFO - GET /logs
2025-09-16 19:07:05,879 - INFO - GET /logs
2025-09-16 19:07:07,610 - INFO - GET /logs
2025-09-16 19:07:08,303 - INFO - GET /logs
2025-09-16 19:07:08,332 - INFO - Optimal number of clusters: 3
2025-09-16 19:07:08,451 - INFO - Combining PCA features with cluster labels
2025-09-16 19:07:08,452 - INFO - Saving preprocessed data
2025-09-16 19:07:08,802 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 19:07:08,803 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 19:07:08,804 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 19:07:08,805 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 19:07:08,807 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 19:19:17,270 - INFO - Logger initialized
2025-09-16 19:19:18,199 - INFO - No GPU detected - using CPU only
2025-09-16 19:19:18,335 - INFO - Model loaded successfully at startup
2025-09-16 19:19:24,827 - INFO - GET /train → train.html
2025-09-16 19:19:30,749 - INFO - POST /train
2025-09-16 19:19:30,753 - INFO - Initializing training process...
2025-09-16 19:19:30,753 - INFO - Running training pipeline...
2025-09-16 19:19:30,753 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 19:19:30,755 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:19:30,755 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 19:19:30,755 - INFO - Starting data preprocessing
2025-09-16 19:19:30,756 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:19:30,756 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 19:19:30,775 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 19:19:30,781 - INFO - Removing 125 duplicate rows
2025-09-16 19:19:30,786 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 19:19:30,787 - INFO - Converting boolean columns to integers
2025-09-16 19:19:30,787 - INFO - Creating interaction features
2025-09-16 19:19:30,790 - INFO - Applying target encoding for Month
2025-09-16 19:19:30,792 - INFO - Applying frequency encoding for VisitorType
2025-09-16 19:19:30,794 - INFO - Transforming skewed features
2025-09-16 19:19:30,828 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 19:19:30,936 - INFO - Scaling features
2025-09-16 19:19:30,949 - INFO - Applying PCA for dimensionality reduction
2025-09-16 19:19:30,962 - INFO - PCA reduced features to: 15 components
2025-09-16 19:19:30,962 - INFO - Applying K-Means clustering
2025-09-16 19:19:53,596 - INFO - Optimal number of clusters: 3
2025-09-16 19:19:53,699 - INFO - Combining PCA features with cluster labels
2025-09-16 19:19:53,700 - INFO - Saving preprocessed data
2025-09-16 19:19:54,108 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 19:19:54,110 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 19:19:54,112 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 19:19:54,113 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 19:19:54,116 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 19:19:54,300 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 19:19:54,300 - INFO - Data preprocessing completed successfully
2025-09-16 19:19:54,303 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 19:19:54,304 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 19:19:54,414 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 19:19:54,423 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 19:20:02,358 - INFO - XGBoost - Best F1 Score: 0.8888, Test F1 Score: 0.8834
2025-09-16 19:20:11,476 - INFO - LightGBM - Best F1 Score: 0.8893, Test F1 Score: 0.8846
2025-09-16 19:21:17,367 - INFO - RandomForest - Best F1 Score: 0.8893, Test F1 Score: 0.8881
2025-09-16 19:22:16,811 - INFO - GradientBoosting - Best F1 Score: 0.8868, Test F1 Score: 0.8844
2025-09-16 19:22:16,820 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
RandomForest      0.887109  0.880248  0.896066  0.888087  0.952936  0.889325
LightGBM          0.883467  0.876131  0.893152   0.88456  0.950258   0.88931
GradientBoosting  0.883952  0.880964   0.88781  0.884373  0.950352  0.886778
XGBoost           0.882739  0.878119  0.888781  0.883418  0.952075  0.888787
2025-09-16 19:22:16,821 - INFO - 
Best model: RandomForest
2025-09-16 19:22:16,904 - INFO - Accuracy: 0.8871
2025-09-16 19:22:16,906 - INFO - Precision: 0.8802
2025-09-16 19:22:16,908 - INFO - Recall: 0.8961
2025-09-16 19:22:16,910 - INFO - F1 Score: 0.8881
2025-09-16 19:22:16,912 - INFO - ROC AUC: 0.9529
2025-09-16 19:22:16,919 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.89      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 19:22:17,084 - INFO - 
Overfitting Check:
2025-09-16 19:22:17,091 - INFO - Train F1 Score: 0.9498
2025-09-16 19:22:17,093 - INFO - Test F1 Score: 0.8881
2025-09-16 19:22:17,097 - INFO - Train ROC AUC: 0.9900
2025-09-16 19:22:17,102 - INFO - Test ROC AUC: 0.9529
2025-09-16 19:22:17,179 - INFO - Best model saved to models\best_model.pkl
2025-09-16 19:22:17,179 - INFO - Generating evaluation plots (model metrics)
2025-09-16 19:22:17,850 - ERROR - Failed to generate evaluation plots: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 19:22:17,851 - ERROR - Model training failed: 'dict' object has no attribute 'tolist'
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 19:22:17,852 - ERROR - Training failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 232, in train
    trained_model = train_model()
                    ^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 313, in train_model
    generate_evaluation_plots(y_test, y_pred, y_prob, best_model_name, X_test, best_model)
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\src\pipelines\training_pipeline.py", line 338, in generate_evaluation_plots
    fig_dict['data'][0]['z'] = fig_dict['data'][0]['z'].tolist()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'tolist'
2025-09-16 19:35:24,013 - INFO - Logger initialized
2025-09-16 19:35:26,416 - INFO - No GPU detected - using CPU only
2025-09-16 19:35:26,499 - INFO - Model loaded successfully at startup
2025-09-16 19:35:34,880 - INFO - GET /train → train.html
2025-09-16 19:35:38,840 - INFO - POST /train
2025-09-16 19:35:38,840 - INFO - Initializing training process...
2025-09-16 19:35:38,840 - INFO - Running training pipeline...
2025-09-16 19:35:38,841 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 19:35:38,842 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:35:38,842 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 19:35:38,843 - INFO - Starting data preprocessing
2025-09-16 19:35:38,844 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 19:35:38,844 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 19:35:38,866 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 19:35:38,871 - INFO - Removing 125 duplicate rows
2025-09-16 19:35:38,879 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 19:35:38,879 - INFO - Converting boolean columns to integers
2025-09-16 19:35:38,879 - INFO - Creating interaction features
2025-09-16 19:35:38,882 - INFO - Applying target encoding for Month
2025-09-16 19:35:38,884 - INFO - Applying frequency encoding for VisitorType
2025-09-16 19:35:38,886 - INFO - Transforming skewed features
2025-09-16 19:35:38,921 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 19:35:39,042 - INFO - Scaling features
2025-09-16 19:35:39,053 - INFO - Applying PCA for dimensionality reduction
2025-09-16 19:35:39,065 - INFO - PCA reduced features to: 15 components
2025-09-16 19:35:39,065 - INFO - Applying K-Means clustering
2025-09-16 19:36:00,992 - INFO - Optimal number of clusters: 3
2025-09-16 19:36:01,100 - INFO - Combining PCA features with cluster labels
2025-09-16 19:36:01,101 - INFO - Saving preprocessed data
2025-09-16 19:36:01,446 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 19:36:01,447 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 19:36:01,449 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 19:36:01,450 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 19:36:01,451 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 19:36:01,584 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 19:36:01,584 - INFO - Data preprocessing completed successfully
2025-09-16 19:36:01,587 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 19:36:01,587 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 19:36:01,648 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 19:36:01,654 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 19:36:09,357 - INFO - XGBoost - Best F1 Score: 0.8888, Test F1 Score: 0.8834
2025-09-16 19:36:19,719 - INFO - LightGBM - Best F1 Score: 0.8893, Test F1 Score: 0.8846
2025-09-16 19:37:25,470 - INFO - RandomForest - Best F1 Score: 0.8893, Test F1 Score: 0.8881
2025-09-16 19:38:26,207 - INFO - GradientBoosting - Best F1 Score: 0.8868, Test F1 Score: 0.8844
2025-09-16 19:38:26,248 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
RandomForest      0.887109  0.880248  0.896066  0.888087  0.952936  0.889325
LightGBM          0.883467  0.876131  0.893152   0.88456  0.950258   0.88931
GradientBoosting  0.883952  0.880964   0.88781  0.884373  0.950352  0.886778
XGBoost           0.882739  0.878119  0.888781  0.883418  0.952075  0.888787
2025-09-16 19:38:26,249 - INFO - 
Best model: RandomForest
2025-09-16 19:38:26,334 - INFO - Accuracy: 0.8871
2025-09-16 19:38:26,336 - INFO - Precision: 0.8802
2025-09-16 19:38:26,338 - INFO - Recall: 0.8961
2025-09-16 19:38:26,340 - INFO - F1 Score: 0.8881
2025-09-16 19:38:26,341 - INFO - ROC AUC: 0.9529
2025-09-16 19:38:26,350 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.89      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 19:38:26,516 - INFO - 
Overfitting Check:
2025-09-16 19:38:26,521 - INFO - Train F1 Score: 0.9498
2025-09-16 19:38:26,523 - INFO - Test F1 Score: 0.8881
2025-09-16 19:38:26,526 - INFO - Train ROC AUC: 0.9900
2025-09-16 19:38:26,528 - INFO - Test ROC AUC: 0.9529
2025-09-16 19:38:26,594 - INFO - Best model saved to models\best_model.pkl
2025-09-16 19:38:26,595 - INFO - Generating evaluation plots (model metrics)
2025-09-16 19:38:27,284 - INFO - Saved confusion matrix plot to static/plots/confusion_matrix_RandomForest.png
2025-09-16 19:38:27,385 - INFO - Saved ROC curve plot to static/plots/roc_curve_RandomForest.png
2025-09-16 19:38:27,408 - INFO - Generating feature importance plot
2025-09-16 19:38:27,626 - INFO - Saved feature importance plot to static/plots/feature_importance_RandomForest.png
2025-09-16 19:38:27,626 - INFO - Model training completed successfully
2025-09-16 19:38:27,654 - INFO - Training completed successfully
2025-09-16 19:38:27,654 - INFO - Training completed successfully
2025-09-16 19:43:37,097 - INFO - GET /home → home.html
2025-09-16 20:55:42,087 - INFO - Logger initialized
2025-09-16 20:57:08,923 - INFO - Logger initialized
2025-09-16 20:57:28,172 - INFO - Logger initialized
2025-09-16 21:03:47,350 - INFO - Logger initialized
2025-09-16 21:03:50,882 - INFO - No GPU detected - using CPU only
2025-09-16 21:03:50,883 - INFO - Initializing Dash app at /eda/
2025-09-16 21:03:51,392 - INFO - Successfully loaded clean.csv
2025-09-16 21:03:52,538 - INFO - Dash app layout set up
2025-09-16 21:03:52,539 - INFO - Dash app initialized at /eda/
2025-09-16 21:03:52,556 - WARNING - Could not load model at startup: node array from the pickle has an incompatible dtype:
- expected: {'names': ['left_child', 'right_child', 'feature', 'threshold', 'impurity', 'n_node_samples', 'weighted_n_node_samples', 'missing_go_to_left'], 'formats': ['<i8', '<i8', '<i8', '<f8', '<f8', '<i8', '<f8', 'u1'], 'offsets': [0, 8, 16, 24, 32, 40, 48, 56], 'itemsize': 64}
- got     : [('left_child', '<i8'), ('right_child', '<i8'), ('feature', '<i8'), ('threshold', '<f8'), ('impurity', '<f8'), ('n_node_samples', '<i8'), ('weighted_n_node_samples', '<f8')]
2025-09-16 21:04:22,113 - INFO - GET / → redirect to /home
2025-09-16 21:04:53,994 - INFO - GET /train → train.html
2025-09-16 21:08:16,653 - INFO - GET /home → home.html
2025-09-16 21:11:50,914 - INFO - GET /home → home.html
2025-09-16 21:14:59,855 - INFO - Logger initialized
2025-09-16 21:15:02,395 - INFO - No GPU detected - using CPU only
2025-09-16 21:15:02,396 - INFO - Initializing Dash app at /eda/
2025-09-16 21:15:02,875 - INFO - Successfully loaded clean.csv
2025-09-16 21:15:04,141 - INFO - Dash app layout set up
2025-09-16 21:15:04,142 - INFO - Dash app initialized at /eda/
2025-09-16 21:15:04,146 - WARNING - Could not load model at startup: node array from the pickle has an incompatible dtype:
- expected: {'names': ['left_child', 'right_child', 'feature', 'threshold', 'impurity', 'n_node_samples', 'weighted_n_node_samples', 'missing_go_to_left'], 'formats': ['<i8', '<i8', '<i8', '<f8', '<f8', '<i8', '<f8', 'u1'], 'offsets': [0, 8, 16, 24, 32, 40, 48, 56], 'itemsize': 64}
- got     : [('left_child', '<i8'), ('right_child', '<i8'), ('feature', '<i8'), ('threshold', '<f8'), ('impurity', '<f8'), ('n_node_samples', '<i8'), ('weighted_n_node_samples', '<f8')]
2025-09-16 21:15:39,437 - INFO - GET /train → train.html
2025-09-16 21:15:52,737 - INFO - POST /train
2025-09-16 21:15:52,743 - INFO - Initializing training process...
2025-09-16 21:15:52,743 - INFO - Running training pipeline...
2025-09-16 21:15:52,743 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-16 21:15:52,744 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 21:15:52,744 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-16 21:15:52,745 - INFO - Starting data preprocessing
2025-09-16 21:15:52,746 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-16 21:15:52,746 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-16 21:15:52,764 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-16 21:15:52,772 - INFO - Removing 125 duplicate rows
2025-09-16 21:15:52,779 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-16 21:15:52,779 - INFO - Converting boolean columns to integers
2025-09-16 21:15:52,780 - INFO - Creating interaction features
2025-09-16 21:15:52,783 - INFO - Applying target encoding for Month
2025-09-16 21:15:52,787 - INFO - Applying frequency encoding for VisitorType
2025-09-16 21:15:52,788 - INFO - Transforming skewed features
2025-09-16 21:15:52,827 - INFO - Applying SMOTE to handle class imbalance
2025-09-16 21:15:52,992 - INFO - Scaling features
2025-09-16 21:15:53,002 - INFO - Applying PCA for dimensionality reduction
2025-09-16 21:15:53,024 - INFO - PCA reduced features to: 15 components
2025-09-16 21:15:53,024 - INFO - Applying K-Means clustering
2025-09-16 21:16:16,934 - INFO - Optimal number of clusters: 3
2025-09-16 21:16:17,025 - INFO - Combining PCA features with cluster labels
2025-09-16 21:16:17,026 - INFO - Saving preprocessed data
2025-09-16 21:16:17,414 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-16 21:16:17,416 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-16 21:16:17,417 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-16 21:16:17,424 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-16 21:16:17,434 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-16 21:16:17,579 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-16 21:16:17,579 - INFO - Data preprocessing completed successfully
2025-09-16 21:16:17,582 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-16 21:16:17,582 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-16 21:16:17,648 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-16 21:16:17,662 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-16 21:16:28,830 - INFO - XGBoost - Best F1 Score: 0.8884, Test F1 Score: 0.8837
2025-09-16 21:16:34,312 - INFO - LightGBM - Best F1 Score: 0.8873, Test F1 Score: 0.8819
2025-09-16 21:17:13,519 - INFO - RandomForest - Best F1 Score: 0.8893, Test F1 Score: 0.8884
2025-09-16 21:17:54,290 - INFO - GradientBoosting - Best F1 Score: 0.8892, Test F1 Score: 0.8807
2025-09-16 21:17:54,296 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
RandomForest      0.887109  0.878083   0.89898  0.888409  0.953085  0.889276
XGBoost           0.882981  0.877815  0.889752  0.883743  0.950892   0.88842
LightGBM          0.881039  0.875539  0.888295  0.881871  0.950012  0.887344
GradientBoosting  0.880311  0.877896  0.883439  0.880658  0.949823  0.889193
2025-09-16 21:17:54,296 - INFO - 
Best model: RandomForest
2025-09-16 21:17:54,353 - INFO - Accuracy: 0.8871
2025-09-16 21:17:54,356 - INFO - Precision: 0.8781
2025-09-16 21:17:54,358 - INFO - Recall: 0.8990
2025-09-16 21:17:54,360 - INFO - F1 Score: 0.8884
2025-09-16 21:17:54,362 - INFO - ROC AUC: 0.9531
2025-09-16 21:17:54,369 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-16 21:17:54,453 - INFO - 
Overfitting Check:
2025-09-16 21:17:54,458 - INFO - Train F1 Score: 0.9452
2025-09-16 21:17:54,460 - INFO - Test F1 Score: 0.8884
2025-09-16 21:17:54,465 - INFO - Train ROC AUC: 0.9849
2025-09-16 21:17:54,466 - INFO - Test ROC AUC: 0.9531
2025-09-16 21:17:54,493 - INFO - Best model saved to models\best_model.pkl
2025-09-16 21:17:54,494 - INFO - Generating evaluation plots (model metrics)
2025-09-16 21:17:54,894 - INFO - Saved confusion matrix plot to static/plots/confusion_matrix_RandomForest.png
2025-09-16 21:17:54,985 - INFO - Saved ROC curve plot to static/plots/roc_curve_RandomForest.png
2025-09-16 21:17:55,001 - INFO - Generating feature importance plot
2025-09-16 21:17:55,153 - INFO - Saved feature importance plot to static/plots/feature_importance_RandomForest.png
2025-09-16 21:17:55,154 - INFO - Model training completed successfully
2025-09-16 21:17:55,155 - INFO - Training completed successfully
2025-09-16 21:17:55,155 - INFO - Training completed successfully
2025-09-16 21:23:15,951 - INFO - GET /predict → predict.html
2025-09-16 21:23:18,598 - INFO - POST /predict
2025-09-16 21:23:18,599 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 273, in predict_route
    if trained_model is None:
       ^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'trained_model' where it is not associated with a value
2025-09-16 21:28:04,904 - INFO - Logger initialized
2025-09-16 21:28:07,124 - INFO - No GPU detected - using CPU only
2025-09-16 21:28:07,126 - INFO - Initializing Dash app at /eda/
2025-09-16 21:28:07,766 - INFO - Successfully loaded clean.csv
2025-09-16 21:28:09,531 - INFO - Dash app layout set up
2025-09-16 21:28:09,531 - INFO - Dash app initialized at /eda/
2025-09-16 21:28:09,576 - INFO - Model loaded successfully at startup
2025-09-16 21:28:11,092 - INFO - GET /predict → predict.html
2025-09-16 21:28:13,734 - INFO - POST /predict
2025-09-16 21:28:13,737 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:28:13,737 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:13,737 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:13,738 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:15,471 - INFO - POST /predict
2025-09-16 21:28:15,472 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:28:15,473 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:15,473 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:15,473 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:15,983 - INFO - POST /predict
2025-09-16 21:28:15,984 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:28:15,985 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:15,985 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:15,985 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:16,245 - INFO - POST /predict
2025-09-16 21:28:16,246 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:28:16,247 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:16,247 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:16,247 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:16,404 - INFO - POST /predict
2025-09-16 21:28:16,405 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:28:16,406 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:16,406 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:28:16,406 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:29:00,821 - INFO - GET /predict → predict.html
2025-09-16 21:29:02,304 - INFO - POST /predict
2025-09-16 21:29:02,306 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:29:02,306 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:29:02,307 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:29:02,307 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:29:11,170 - INFO - Logger initialized
2025-09-16 21:29:13,398 - INFO - No GPU detected - using CPU only
2025-09-16 21:29:13,399 - INFO - Initializing Dash app at /eda/
2025-09-16 21:29:13,858 - INFO - Successfully loaded clean.csv
2025-09-16 21:29:14,906 - INFO - Dash app layout set up
2025-09-16 21:29:14,907 - INFO - Dash app initialized at /eda/
2025-09-16 21:29:14,940 - INFO - Model loaded successfully at startup
2025-09-16 21:29:19,381 - INFO - GET /predict → predict.html
2025-09-16 21:29:21,549 - INFO - POST /predict
2025-09-16 21:29:21,553 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:29:21,554 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:29:21,554 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:29:21,554 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:30:03,525 - INFO - Logger initialized
2025-09-16 21:30:05,656 - INFO - No GPU detected - using CPU only
2025-09-16 21:30:05,657 - INFO - Initializing Dash app at /eda/
2025-09-16 21:30:06,135 - INFO - Successfully loaded clean.csv
2025-09-16 21:30:07,392 - INFO - Dash app layout set up
2025-09-16 21:30:07,392 - INFO - Dash app initialized at /eda/
2025-09-16 21:30:07,430 - INFO - Model loaded successfully at startup
2025-09-16 21:30:08,479 - INFO - GET /predict → predict.html
2025-09-16 21:30:12,597 - INFO - POST /predict
2025-09-16 21:30:12,599 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:30:12,599 - ERROR - Error in preprocessing single instance: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:30:12,600 - ERROR - Error in prediction: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:30:12,600 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 96, in preprocess_single_instance
    pt = joblib.load(os.path.join(preprocessor_path, 'power_transformer.pkl'))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\AppData\Roaming\Python\Python311\site-packages\joblib\numpy_pickle.py", line 650, in load
    with open(filename, 'rb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'models\\power_transformer.pkl'
2025-09-16 21:31:12,692 - INFO - Logger initialized
2025-09-16 21:31:14,833 - INFO - No GPU detected - using CPU only
2025-09-16 21:31:14,833 - INFO - Initializing Dash app at /eda/
2025-09-16 21:31:15,347 - INFO - Successfully loaded clean.csv
2025-09-16 21:31:16,409 - INFO - Dash app layout set up
2025-09-16 21:31:16,409 - INFO - Dash app initialized at /eda/
2025-09-16 21:31:16,443 - INFO - Model loaded successfully at startup
2025-09-16 21:31:17,023 - INFO - POST /predict
2025-09-16 21:31:17,025 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:31:17,077 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:31:17,078 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:31:17,078 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:32:00,365 - INFO - POST /predict
2025-09-16 21:32:00,366 - INFO - Predict payload: {'Administrative': 20.0, 'Administrative_Duration': 2.0, 'Informational': 10.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 4.99, 'SpecialDay': 5.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:32:00,375 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:32:00,375 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:32:00,375 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:32:07,383 - INFO - POST /predict
2025-09-16 21:32:07,384 - INFO - Predict payload: {'Administrative': 20.0, 'Administrative_Duration': 2.0, 'Informational': 10.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 4.99, 'SpecialDay': 5.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 1, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:32:07,393 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:32:07,393 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:32:07,393 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:45:12,706 - INFO - POST /predict
2025-09-16 21:45:12,708 - INFO - Predict payload: {'Administrative': 20.0, 'Administrative_Duration': 2.0, 'Informational': 10.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 4.99, 'SpecialDay': 5.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 1, 'Month': 'May', 'VisitorType': 'Other'}
2025-09-16 21:45:12,752 - INFO - Prediction: 0, Probability: [0.851175 0.148825]
2025-09-16 21:45:49,801 - INFO - POST /predict
2025-09-16 21:45:49,803 - INFO - Predict payload: {'Administrative': 20.0, 'Administrative_Duration': 2.0, 'Informational': 10.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 4.99, 'SpecialDay': 5.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 1, 'Month': 'May', 'VisitorType': 'Other'}
2025-09-16 21:45:49,844 - INFO - Prediction: 0, Probability: [0.851175 0.148825]
2025-09-16 21:45:54,337 - INFO - POST /predict
2025-09-16 21:45:54,339 - INFO - Predict payload: {'Administrative': 20.0, 'Administrative_Duration': 2.0, 'Informational': 10.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 4.99, 'SpecialDay': 5.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 1, 'Month': 'May', 'VisitorType': 'New_Visitor'}
2025-09-16 21:45:54,379 - INFO - Prediction: 0, Probability: [0.85367454 0.14632546]
2025-09-16 21:51:49,618 - INFO - GET /predict → predict.html
2025-09-16 21:51:52,840 - INFO - POST /predict
2025-09-16 21:51:52,841 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:51:52,851 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:51:52,852 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:51:52,852 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:52:27,412 - INFO - POST /predict
2025-09-16 21:52:27,413 - INFO - Predict payload: {'Administrative': 5.0, 'Administrative_Duration': 5.0, 'Informational': 5.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 1.0, 'SpecialDay': 0.49, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:52:27,421 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:52:27,422 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:52:27,422 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:52:30,386 - INFO - POST /predict
2025-09-16 21:52:30,388 - INFO - Predict payload: {'Administrative': 5.0, 'Administrative_Duration': 5.0, 'Informational': 5.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 1.0, 'SpecialDay': 0.49, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:52:30,396 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:52:30,396 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:52:30,396 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:53:09,677 - INFO - POST /predict
2025-09-16 21:53:09,678 - INFO - Predict payload: {'Administrative': 5.0, 'Administrative_Duration': 5.0, 'Informational': 5.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 1.0, 'SpecialDay': 0.49, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'New_Visitor'}
2025-09-16 21:53:09,687 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:53:09,687 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:53:09,687 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:53:12,678 - INFO - POST /predict
2025-09-16 21:53:12,680 - INFO - Predict payload: {'Administrative': 5.0, 'Administrative_Duration': 5.0, 'Informational': 5.0, 'Informational_Duration': 2.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 2.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 1.0, 'SpecialDay': 0.49, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Apr', 'VisitorType': 'New_Visitor'}
2025-09-16 21:53:12,689 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:53:12,689 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:53:12,689 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:54:53,392 - INFO - Logger initialized
2025-09-16 21:54:55,649 - INFO - No GPU detected - using CPU only
2025-09-16 21:54:55,650 - INFO - Initializing Dash app at /eda/
2025-09-16 21:54:56,100 - INFO - Successfully loaded clean.csv
2025-09-16 21:54:57,264 - INFO - Dash app layout set up
2025-09-16 21:54:57,265 - INFO - Dash app initialized at /eda/
2025-09-16 21:54:57,300 - INFO - Model loaded successfully at startup
2025-09-16 21:55:01,093 - INFO - GET /predict → predict.html
2025-09-16 21:55:07,336 - INFO - POST /predict
2025-09-16 21:55:07,338 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 21:55:07,348 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:55:07,349 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 21:55:07,349 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 22:15:14,436 - INFO - Logger initialized
2025-09-16 22:15:16,585 - INFO - No GPU detected - using CPU only
2025-09-16 22:15:16,586 - INFO - Initializing Dash app at /eda/
2025-09-16 22:15:17,067 - INFO - Successfully loaded clean.csv
2025-09-16 22:15:18,188 - INFO - Dash app layout set up
2025-09-16 22:15:18,189 - INFO - Dash app initialized at /eda/
2025-09-16 22:15:18,224 - INFO - Model loaded successfully at startup
2025-09-16 22:15:24,033 - INFO - GET /predict → predict.html
2025-09-16 22:15:26,545 - INFO - POST /predict
2025-09-16 22:15:26,548 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:15:26,558 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 22:15:26,558 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 22:15:26,559 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 283, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 164, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 144, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 22:19:46,111 - INFO - Logger initialized
2025-09-16 22:19:48,240 - INFO - No GPU detected - using CPU only
2025-09-16 22:19:48,242 - INFO - Initializing Dash app at /eda/
2025-09-16 22:19:48,717 - INFO - Successfully loaded clean.csv
2025-09-16 22:19:49,760 - INFO - Dash app layout set up
2025-09-16 22:19:49,761 - INFO - Dash app initialized at /eda/
2025-09-16 22:19:49,793 - INFO - Model loaded successfully at startup
2025-09-16 22:19:49,862 - INFO - GET /predict → predict.html
2025-09-16 22:19:52,024 - INFO - POST /predict
2025-09-16 22:19:52,027 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:19:52,031 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Jan', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:19:52,038 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': nan, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:19:52,039 - ERROR - Error in preprocessing single instance: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 22:19:52,040 - ERROR - Error in prediction: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 22:19:52,040 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 284, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 165, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 145, in preprocess_single_instance
    X_pca = pca.transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\_set_output.py", line 295, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\decomposition\_base.py", line 145, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\base.py", line 633, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array
    _assert_all_finite(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-16 22:22:01,011 - INFO - POST /predict
2025-09-16 22:22:01,012 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:22:01,015 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:22:01,021 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:22:01,057 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-16 22:22:16,637 - INFO - POST /predict
2025-09-16 22:22:16,638 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'May', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:22:16,641 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'May', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:22:16,646 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.10964253529588465, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:22:16,680 - INFO - Prediction: 0, Probability: [1. 0.]
2025-09-16 22:22:35,775 - INFO - POST /predict
2025-09-16 22:22:35,777 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'May', 'VisitorType': 'New_Visitor'}
2025-09-16 22:22:35,780 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'May', 'VisitorType': 'New_Visitor'}
2025-09-16 22:22:35,786 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.10964253529588465, 'VisitorType_Freq': 0.13871364195002048, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:22:35,823 - INFO - Prediction: 0, Probability: [0.98583494 0.01416506]
2025-09-16 22:29:15,224 - INFO - POST /predict
2025-09-16 22:29:15,226 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Other'}
2025-09-16 22:29:15,229 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Other'}
2025-09-16 22:29:15,235 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.0066366243342892255, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:29:15,271 - INFO - Prediction: 0, Probability: [0.90333617 0.09666383]
2025-09-16 22:39:26,852 - INFO - GET /predict → predict.html
2025-09-16 22:39:42,088 - INFO - Logger initialized
2025-09-16 22:39:44,307 - INFO - No GPU detected - using CPU only
2025-09-16 22:39:44,308 - INFO - Initializing Dash app at /eda/
2025-09-16 22:39:44,753 - INFO - Successfully loaded clean.csv
2025-09-16 22:39:45,802 - INFO - Dash app layout set up
2025-09-16 22:39:45,803 - INFO - Dash app initialized at /eda/
2025-09-16 22:39:45,837 - INFO - Model loaded successfully at startup
2025-09-16 22:39:46,098 - INFO - GET /predict → predict.html
2025-09-16 22:39:51,664 - INFO - POST /predict
2025-09-16 22:39:51,666 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:39:51,670 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:39:51,678 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:39:51,713 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-16 22:46:14,338 - INFO - GET /train → train.html
2025-09-16 22:48:50,220 - INFO - Logger initialized
2025-09-16 22:48:52,501 - INFO - No GPU detected - using CPU only
2025-09-16 22:48:52,502 - INFO - Initializing Dash app at /eda/
2025-09-16 22:48:52,954 - INFO - Successfully loaded clean.csv
2025-09-16 22:48:54,018 - INFO - Dash app layout set up
2025-09-16 22:48:54,018 - INFO - Dash app initialized at /eda/
2025-09-16 22:48:54,055 - INFO - Model loaded successfully at startup
2025-09-16 22:48:55,861 - INFO - GET /train → train.html
2025-09-16 22:48:57,559 - INFO - GET /predict → predict.html
2025-09-16 22:49:00,365 - INFO - POST /predict
2025-09-16 22:49:00,365 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:00,370 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:00,378 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:49:00,411 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-16 22:49:11,107 - INFO - POST /predict
2025-09-16 22:49:11,108 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:11,111 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:11,116 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:49:11,149 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-16 22:49:25,845 - INFO - POST /predict
2025-09-16 22:49:25,845 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:25,849 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:25,854 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:49:25,886 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-16 22:49:27,159 - INFO - POST /predict
2025-09-16 22:49:27,159 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:27,162 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:27,167 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:49:27,200 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-16 22:49:35,026 - INFO - Logger initialized
2025-09-16 22:49:37,653 - INFO - No GPU detected - using CPU only
2025-09-16 22:49:37,654 - INFO - Initializing Dash app at /eda/
2025-09-16 22:49:38,133 - INFO - Successfully loaded clean.csv
2025-09-16 22:49:39,190 - INFO - Dash app layout set up
2025-09-16 22:49:39,191 - INFO - Dash app initialized at /eda/
2025-09-16 22:49:39,222 - INFO - Model loaded successfully at startup
2025-09-16 22:49:39,449 - INFO - GET /predict → predict.html
2025-09-16 22:49:41,789 - INFO - POST /predict
2025-09-16 22:49:41,791 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:41,795 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:49:41,802 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:49:41,837 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-16 22:56:51,867 - INFO - Logger initialized
2025-09-16 22:56:54,101 - INFO - No GPU detected - using CPU only
2025-09-16 22:56:54,103 - INFO - Initializing Dash app at /eda/
2025-09-16 22:56:54,610 - INFO - Successfully loaded clean.csv
2025-09-16 22:56:55,816 - INFO - Dash app layout set up
2025-09-16 22:56:55,817 - INFO - Dash app initialized at /eda/
2025-09-16 22:56:55,849 - INFO - Model loaded successfully at startup
2025-09-16 22:56:56,088 - INFO - GET /predict → predict.html
2025-09-16 22:56:58,657 - INFO - POST /predict
2025-09-16 22:56:58,658 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:56:58,662 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 22:56:58,670 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:56:58,703 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-16 22:57:10,347 - INFO - POST /predict
2025-09-16 22:57:10,347 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'New_Visitor'}
2025-09-16 22:57:10,350 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'New_Visitor'}
2025-09-16 22:57:10,356 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.13871364195002048, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 22:57:10,389 - INFO - Prediction: 0, Probability: [0.88833556 0.11166444]
2025-09-16 23:00:12,486 - INFO - POST /predict
2025-09-16 23:00:12,486 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'New_Visitor'}
2025-09-16 23:00:12,490 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'New_Visitor'}
2025-09-16 23:00:12,496 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.13871364195002048, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:00:12,528 - INFO - Prediction: 0, Probability: [0.88833556 0.11166444]
2025-09-16 23:00:14,046 - INFO - POST /predict
2025-09-16 23:00:14,046 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'New_Visitor'}
2025-09-16 23:00:14,049 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'New_Visitor'}
2025-09-16 23:00:14,055 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.13871364195002048, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:00:14,086 - INFO - Prediction: 0, Probability: [0.88833556 0.11166444]
2025-09-16 23:04:09,198 - INFO - Logger initialized
2025-09-16 23:04:11,456 - INFO - No GPU detected - using CPU only
2025-09-16 23:04:11,457 - INFO - Initializing Dash app at /eda/
2025-09-16 23:04:11,961 - INFO - Successfully loaded clean.csv
2025-09-16 23:04:13,112 - INFO - Dash app layout set up
2025-09-16 23:04:13,114 - INFO - Dash app initialized at /eda/
2025-09-16 23:04:13,146 - INFO - Model loaded successfully at startup
2025-09-16 23:04:16,275 - INFO - GET /predict → predict.html
2025-09-16 23:04:22,511 - INFO - POST /predict
2025-09-16 23:04:22,511 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:04:22,516 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:04:22,524 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:04:22,578 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-16 23:05:11,181 - INFO - Logger initialized
2025-09-16 23:05:13,434 - INFO - No GPU detected - using CPU only
2025-09-16 23:05:13,434 - INFO - Initializing Dash app at /eda/
2025-09-16 23:05:13,919 - INFO - Successfully loaded clean.csv
2025-09-16 23:05:15,006 - INFO - Dash app layout set up
2025-09-16 23:05:15,006 - INFO - Dash app initialized at /eda/
2025-09-16 23:05:15,043 - INFO - Model loaded successfully at startup
2025-09-16 23:05:15,132 - INFO - GET /predict → predict.html
2025-09-16 23:05:19,909 - INFO - POST /predict
2025-09-16 23:05:19,911 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:05:19,914 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:05:19,921 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:05:19,956 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-16 23:06:18,654 - INFO - GET /predict → predict.html
2025-09-16 23:06:27,888 - INFO - POST /predict
2025-09-16 23:06:27,889 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:06:27,893 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:06:27,900 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:06:27,932 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-16 23:06:31,850 - INFO - POST /predict
2025-09-16 23:06:31,852 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:06:31,855 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:06:31,863 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:06:31,895 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-16 23:09:16,583 - INFO - Logger initialized
2025-09-16 23:09:18,786 - INFO - No GPU detected - using CPU only
2025-09-16 23:09:18,788 - INFO - Initializing Dash app at /eda/
2025-09-16 23:09:19,297 - INFO - Successfully loaded clean.csv
2025-09-16 23:09:20,426 - INFO - Dash app layout set up
2025-09-16 23:09:20,427 - INFO - Dash app initialized at /eda/
2025-09-16 23:09:20,460 - INFO - Model loaded successfully at startup
2025-09-16 23:09:21,264 - INFO - GET /predict → predict.html
2025-09-16 23:09:26,866 - INFO - POST /predict
2025-09-16 23:09:26,868 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:09:26,871 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:09:26,880 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:09:26,916 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-16 23:09:34,877 - INFO - GET /home → home.html
2025-09-16 23:12:19,430 - INFO - GET /home → home.html
2025-09-16 23:12:28,902 - INFO - Logger initialized
2025-09-16 23:12:31,102 - INFO - No GPU detected - using CPU only
2025-09-16 23:12:31,104 - INFO - Initializing Dash app at /eda/
2025-09-16 23:12:31,587 - INFO - Successfully loaded clean.csv
2025-09-16 23:12:32,744 - INFO - Dash app layout set up
2025-09-16 23:12:32,745 - INFO - Dash app initialized at /eda/
2025-09-16 23:12:32,778 - INFO - Model loaded successfully at startup
2025-09-16 23:12:32,872 - INFO - GET /home → home.html
2025-09-16 23:13:38,535 - INFO - GET /home → home.html
2025-09-16 23:13:47,635 - INFO - Logger initialized
2025-09-16 23:13:49,738 - INFO - No GPU detected - using CPU only
2025-09-16 23:13:49,740 - INFO - Initializing Dash app at /eda/
2025-09-16 23:13:50,195 - INFO - Successfully loaded clean.csv
2025-09-16 23:13:51,270 - INFO - Dash app layout set up
2025-09-16 23:13:51,271 - INFO - Dash app initialized at /eda/
2025-09-16 23:13:51,313 - INFO - Model loaded successfully at startup
2025-09-16 23:13:51,501 - INFO - GET /home → home.html
2025-09-16 23:14:28,579 - INFO - GET /predict → predict.html
2025-09-16 23:15:08,469 - INFO - GET /home → home.html
2025-09-16 23:15:18,030 - INFO - Logger initialized
2025-09-16 23:15:20,206 - INFO - No GPU detected - using CPU only
2025-09-16 23:15:20,207 - INFO - Initializing Dash app at /eda/
2025-09-16 23:15:20,660 - INFO - Successfully loaded clean.csv
2025-09-16 23:15:21,762 - INFO - Dash app layout set up
2025-09-16 23:15:21,763 - INFO - Dash app initialized at /eda/
2025-09-16 23:15:21,795 - INFO - Model loaded successfully at startup
2025-09-16 23:28:58,880 - INFO - Logger initialized
2025-09-16 23:29:01,389 - INFO - No GPU detected - using CPU only
2025-09-16 23:29:01,390 - INFO - Initializing Dash app at /eda/
2025-09-16 23:29:01,857 - INFO - Successfully loaded clean.csv
2025-09-16 23:29:03,834 - INFO - Dash app layout set up
2025-09-16 23:29:03,834 - INFO - Dash app initialized at /eda/
2025-09-16 23:29:03,876 - INFO - Model loaded successfully at startup
2025-09-16 23:29:04,699 - INFO - GET /home → home.html
2025-09-16 23:29:33,972 - INFO - GET /predict → predict.html
2025-09-16 23:29:37,169 - INFO - POST /predict
2025-09-16 23:29:37,172 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:29:37,188 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-16 23:29:37,195 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-16 23:29:37,229 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-16 23:32:51,553 - INFO - GET /train → train.html
2025-09-16 23:40:06,832 - INFO - Logger initialized
2025-09-16 23:40:08,968 - INFO - No GPU detected - using CPU only
2025-09-16 23:40:08,969 - INFO - Initializing Dash app at /eda/
2025-09-16 23:40:09,418 - INFO - Successfully loaded clean.csv
2025-09-16 23:40:10,458 - INFO - Dash app layout set up
2025-09-16 23:40:10,458 - INFO - Dash app initialized at /eda/
2025-09-16 23:40:10,490 - INFO - Model loaded successfully at startup
2025-09-16 23:47:36,373 - INFO - GET /train → train.html
2025-09-16 23:55:51,035 - INFO - GET /train → train.html
2025-09-16 23:56:03,400 - INFO - GET /train → train.html
2025-09-16 23:56:12,599 - INFO - Logger initialized
2025-09-16 23:56:14,813 - INFO - No GPU detected - using CPU only
2025-09-16 23:56:14,815 - INFO - Initializing Dash app at /eda/
2025-09-16 23:56:15,348 - INFO - Successfully loaded clean.csv
2025-09-16 23:56:16,565 - INFO - Dash app layout set up
2025-09-16 23:56:16,565 - INFO - Dash app initialized at /eda/
2025-09-16 23:56:16,599 - INFO - Model loaded successfully at startup
2025-09-16 23:56:16,846 - INFO - GET /train → train.html
2025-09-16 23:57:40,008 - INFO - Logger initialized
2025-09-16 23:57:42,215 - INFO - No GPU detected - using CPU only
2025-09-16 23:57:42,217 - INFO - Initializing Dash app at /eda/
2025-09-16 23:57:42,701 - INFO - Successfully loaded clean.csv
2025-09-16 23:57:43,977 - INFO - Dash app layout set up
2025-09-16 23:57:43,978 - INFO - Dash app initialized at /eda/
2025-09-16 23:57:44,013 - INFO - Model loaded successfully at startup
2025-09-16 23:57:44,260 - INFO - GET /train → train.html
2025-09-16 23:59:43,705 - INFO - Logger initialized
2025-09-16 23:59:46,098 - INFO - No GPU detected - using CPU only
2025-09-16 23:59:46,100 - INFO - Initializing Dash app at /eda/
2025-09-16 23:59:46,576 - INFO - Successfully loaded clean.csv
2025-09-16 23:59:47,811 - INFO - Dash app layout set up
2025-09-16 23:59:47,811 - INFO - Dash app initialized at /eda/
2025-09-16 23:59:47,849 - INFO - Model loaded successfully at startup
2025-09-16 23:59:59,227 - INFO - GET /train → train.html
2025-09-17 00:00:12,298 - INFO - GET /home → home.html
2025-09-17 00:01:00,631 - INFO - Logger initialized
2025-09-17 00:01:02,692 - INFO - No GPU detected - using CPU only
2025-09-17 00:01:02,693 - INFO - Initializing Dash app at /eda/
2025-09-17 00:01:03,159 - INFO - Successfully loaded clean.csv
2025-09-17 00:01:04,224 - INFO - Dash app layout set up
2025-09-17 00:01:04,225 - INFO - Dash app initialized at /eda/
2025-09-17 00:01:04,259 - INFO - Model loaded successfully at startup
2025-09-17 00:01:04,451 - INFO - GET /home → home.html
2025-09-17 00:03:30,131 - INFO - GET /train → train.html
2025-09-17 00:28:47,332 - INFO - GET /predict → predict.html
2025-09-17 00:29:08,490 - INFO - GET /train → train.html
2025-09-17 00:29:37,713 - INFO - GET /predict → predict.html
2025-09-17 00:44:10,000 - INFO - GET /predict → predict.html
2025-09-17 00:44:12,476 - INFO - GET /predict → predict.html
2025-09-17 00:44:20,143 - INFO - Logger initialized
2025-09-17 00:44:22,381 - INFO - No GPU detected - using CPU only
2025-09-17 00:44:22,383 - INFO - Initializing Dash app at /eda/
2025-09-17 00:44:22,849 - INFO - Successfully loaded clean.csv
2025-09-17 00:44:23,963 - INFO - Dash app layout set up
2025-09-17 00:44:23,964 - INFO - Dash app initialized at /eda/
2025-09-17 00:44:23,996 - INFO - Model loaded successfully at startup
2025-09-17 00:44:25,070 - INFO - GET /predict → predict.html
2025-09-17 00:54:13,683 - INFO - Logger initialized
2025-09-17 00:54:15,926 - INFO - No GPU detected - using CPU only
2025-09-17 00:54:15,928 - INFO - Initializing Dash app at /eda/
2025-09-17 00:54:16,364 - INFO - Successfully loaded clean.csv
2025-09-17 00:54:17,630 - INFO - Dash app layout set up
2025-09-17 00:54:17,630 - INFO - Dash app initialized at /eda/
2025-09-17 00:54:17,665 - INFO - Model loaded successfully at startup
2025-09-17 00:54:20,033 - INFO - GET /predict → predict.html
2025-09-17 00:54:45,582 - INFO - POST /predict
2025-09-17 00:54:45,585 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-17 00:54:45,591 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-17 00:54:45,602 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 00:54:45,640 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-17 01:06:33,901 - INFO - Logger initialized
2025-09-17 01:06:36,381 - INFO - No GPU detected - using CPU only
2025-09-17 01:06:36,382 - INFO - Initializing Dash app at /eda/
2025-09-17 01:06:36,877 - INFO - Successfully loaded clean.csv
2025-09-17 01:06:38,053 - INFO - Dash app layout set up
2025-09-17 01:06:38,053 - INFO - Dash app initialized at /eda/
2025-09-17 01:06:38,087 - INFO - Model loaded successfully at startup
2025-09-17 01:06:38,127 - INFO - GET /predict → predict.html
2025-09-17 01:08:49,173 - INFO - Logger initialized
2025-09-17 01:08:51,449 - INFO - No GPU detected - using CPU only
2025-09-17 01:08:51,450 - INFO - Initializing Dash app at /eda/
2025-09-17 01:08:52,010 - INFO - Successfully loaded clean.csv
2025-09-17 01:08:53,080 - INFO - Dash app layout set up
2025-09-17 01:08:53,080 - INFO - Dash app initialized at /eda/
2025-09-17 01:08:53,113 - INFO - Model loaded successfully at startup
2025-09-17 01:08:53,658 - INFO - GET /predict → predict.html
2025-09-17 01:09:31,825 - INFO - POST /predict
2025-09-17 01:09:31,826 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:09:31,831 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:09:31,837 - ERROR - Error in preprocessing single instance: "['TrafficType'] not in index"
2025-09-17 01:09:31,837 - ERROR - Error in prediction: "['TrafficType'] not in index"
2025-09-17 01:09:31,837 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 284, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 165, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 139, in preprocess_single_instance
    X = df[numeric_features]
        ~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['TrafficType'] not in index"
2025-09-17 01:09:46,273 - INFO - GET /predict → predict.html
2025-09-17 01:09:49,799 - INFO - POST /predict
2025-09-17 01:09:49,800 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:09:49,802 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:09:49,807 - ERROR - Error in preprocessing single instance: "['TrafficType'] not in index"
2025-09-17 01:09:49,807 - ERROR - Error in prediction: "['TrafficType'] not in index"
2025-09-17 01:09:49,807 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 284, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 165, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 139, in preprocess_single_instance
    X = df[numeric_features]
        ~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['TrafficType'] not in index"
2025-09-17 01:09:57,877 - INFO - POST /predict
2025-09-17 01:09:57,877 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:09:57,880 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:09:57,884 - ERROR - Error in preprocessing single instance: "['TrafficType'] not in index"
2025-09-17 01:09:57,884 - ERROR - Error in prediction: "['TrafficType'] not in index"
2025-09-17 01:09:57,885 - ERROR - Prediction failed
Traceback (most recent call last):
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 284, in predict_route
    prediction, probability = predict_single_instance(data, trained_model)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 165, in predict_single_instance
    X_final = preprocess_single_instance(data, preprocessor_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\Desktop\PW-Projects\online_shoppers_intention\app.py", line 139, in preprocess_single_instance
    X = df[numeric_features]
        ~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\drsnc\anaconda3\Lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['TrafficType'] not in index"
2025-09-17 01:10:11,876 - INFO - Logger initialized
2025-09-17 01:10:14,132 - INFO - No GPU detected - using CPU only
2025-09-17 01:10:14,133 - INFO - Initializing Dash app at /eda/
2025-09-17 01:10:14,633 - INFO - Successfully loaded clean.csv
2025-09-17 01:10:15,749 - INFO - Dash app layout set up
2025-09-17 01:10:15,750 - INFO - Dash app initialized at /eda/
2025-09-17 01:10:15,784 - INFO - Model loaded successfully at startup
2025-09-17 01:10:15,941 - INFO - GET /predict → predict.html
2025-09-17 01:10:20,845 - INFO - POST /predict
2025-09-17 01:10:20,847 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:10:20,850 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:10:20,857 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 01:10:20,892 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-17 01:11:29,500 - INFO - Logger initialized
2025-09-17 01:11:31,723 - INFO - No GPU detected - using CPU only
2025-09-17 01:11:31,724 - INFO - Initializing Dash app at /eda/
2025-09-17 01:11:32,192 - INFO - Successfully loaded clean.csv
2025-09-17 01:11:33,298 - INFO - Dash app layout set up
2025-09-17 01:11:33,298 - INFO - Dash app initialized at /eda/
2025-09-17 01:11:33,333 - INFO - Model loaded successfully at startup
2025-09-17 01:11:33,496 - INFO - GET /predict → predict.html
2025-09-17 01:11:38,997 - INFO - POST /predict
2025-09-17 01:11:39,000 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:11:39,003 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Feb', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:11:39,010 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.016574585635359115, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 01:11:39,045 - INFO - Prediction: 0, Probability: [0.97500061 0.02499939]
2025-09-17 01:12:29,000 - INFO - GET /train → train.html
2025-09-17 01:12:37,918 - INFO - GET /predict → predict.html
2025-09-17 01:12:42,854 - INFO - GET /train → train.html
2025-09-17 01:12:52,066 - INFO - GET /home → home.html
2025-09-17 01:13:20,682 - INFO - GET /train → train.html
2025-09-17 01:13:40,548 - INFO - GET /predict → predict.html
2025-09-17 01:25:32,850 - INFO - Logger initialized
2025-09-17 01:25:35,076 - INFO - No GPU detected - using CPU only
2025-09-17 01:25:35,077 - INFO - Initializing Dash app at /eda/
2025-09-17 01:25:35,523 - INFO - Successfully loaded clean.csv
2025-09-17 01:25:36,616 - INFO - Dash app layout set up
2025-09-17 01:25:36,616 - INFO - Dash app initialized at /eda/
2025-09-17 01:25:36,648 - INFO - Model loaded successfully at startup
2025-09-17 01:25:36,784 - INFO - GET /predict → predict.html
2025-09-17 01:25:55,901 - INFO - POST /predict
2025-09-17 01:25:55,901 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:25:55,907 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:25:55,916 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 01:25:55,953 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-17 01:27:01,860 - INFO - GET /predict → predict.html
2025-09-17 01:27:04,365 - INFO - GET /predict → predict.html
2025-09-17 01:27:12,184 - INFO - Logger initialized
2025-09-17 01:27:14,296 - INFO - No GPU detected - using CPU only
2025-09-17 01:27:14,297 - INFO - Initializing Dash app at /eda/
2025-09-17 01:27:14,765 - INFO - Successfully loaded clean.csv
2025-09-17 01:27:15,875 - INFO - Dash app layout set up
2025-09-17 01:27:15,876 - INFO - Dash app initialized at /eda/
2025-09-17 01:27:15,909 - INFO - Model loaded successfully at startup
2025-09-17 01:27:16,743 - INFO - GET /predict → predict.html
2025-09-17 01:31:21,857 - INFO - POST /predict
2025-09-17 01:31:21,857 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:31:21,861 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:31:21,869 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 01:31:21,904 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-17 01:31:39,783 - INFO - GET /home → home.html
2025-09-17 01:31:49,662 - INFO - GET /predict → predict.html
2025-09-17 01:43:51,338 - INFO - GET /predict → predict.html
2025-09-17 01:59:48,384 - INFO - Logger initialized
2025-09-17 01:59:50,680 - INFO - No GPU detected - using CPU only
2025-09-17 01:59:50,680 - INFO - Initializing Dash app at /eda/
2025-09-17 01:59:51,204 - INFO - Successfully loaded clean.csv
2025-09-17 01:59:52,408 - INFO - Dash app layout set up
2025-09-17 01:59:52,409 - INFO - Dash app initialized at /eda/
2025-09-17 01:59:52,445 - INFO - Model loaded successfully at startup
2025-09-17 01:59:58,417 - INFO - POST /predict
2025-09-17 01:59:58,417 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:59:58,421 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 01:59:58,429 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 01:59:58,465 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-17 02:04:32,064 - INFO - GET /predict → predict.html
2025-09-17 02:14:50,555 - INFO - Logger initialized
2025-09-17 02:14:52,845 - INFO - No GPU detected - using CPU only
2025-09-17 02:14:52,846 - INFO - Initializing Dash app at /eda/
2025-09-17 02:14:53,324 - INFO - Successfully loaded clean.csv
2025-09-17 02:14:54,421 - INFO - Dash app layout set up
2025-09-17 02:14:54,422 - INFO - Dash app initialized at /eda/
2025-09-17 02:14:54,454 - INFO - Model loaded successfully at startup
2025-09-17 02:14:54,708 - INFO - GET /predict → predict.html
2025-09-17 02:15:02,646 - INFO - POST /predict
2025-09-17 02:15:02,646 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 02:15:02,649 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 02:15:02,656 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 02:15:02,693 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-17 02:15:47,185 - INFO - GET /predict → predict.html
2025-09-17 02:20:53,962 - INFO - GET /home → home.html
2025-09-17 02:21:02,610 - INFO - GET /predict → predict.html
2025-09-17 02:21:04,066 - INFO - GET /train → train.html
2025-09-17 02:21:05,680 - INFO - GET /predict → predict.html
2025-09-17 02:21:08,364 - INFO - GET /train → train.html
2025-09-17 02:21:09,872 - INFO - GET /predict → predict.html
2025-09-17 02:28:51,050 - INFO - Logger initialized
2025-09-17 02:28:53,597 - INFO - No GPU detected - using CPU only
2025-09-17 02:28:53,599 - INFO - Initializing Dash app at /eda/
2025-09-17 02:28:54,097 - INFO - Successfully loaded clean.csv
2025-09-17 02:28:55,328 - INFO - Dash app layout set up
2025-09-17 02:28:55,329 - INFO - Dash app initialized at /eda/
2025-09-17 02:28:55,363 - INFO - Model loaded successfully at startup
2025-09-17 02:29:03,928 - INFO - GET /predict → predict.html
2025-09-17 02:29:06,999 - INFO - POST /predict
2025-09-17 02:29:07,000 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 02:29:07,005 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 02:29:07,017 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 02:29:07,055 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-17 02:31:19,493 - INFO - GET /predict → predict.html
2025-09-17 02:32:43,237 - INFO - GET /predict → predict.html
2025-09-17 02:33:13,991 - INFO - GET /train → train.html
2025-09-17 02:40:48,845 - INFO - GET /home → home.html
2025-09-17 02:40:53,169 - INFO - GET /train → train.html
2025-09-17 02:41:19,453 - INFO - POST /train
2025-09-17 02:41:19,459 - INFO - Initializing training process...
2025-09-17 02:41:19,459 - INFO - Running training pipeline...
2025-09-17 02:41:19,459 - INFO - Starting model training pipeline (aligned with model_training (1).py)
2025-09-17 02:41:19,469 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-17 02:41:19,469 - INFO - Regenerating preprocessed_data.csv automatically
2025-09-17 02:41:19,469 - INFO - Starting data preprocessing
2025-09-17 02:41:19,470 - INFO - Configuration loaded successfully from src/config/config.yaml
2025-09-17 02:41:19,471 - INFO - Loading data from datasets/raw/online_shoppers_intention.csv
2025-09-17 02:41:19,499 - INFO - Data loaded successfully. Shape: (12330, 18)
2025-09-17 02:41:19,510 - INFO - Removing 125 duplicate rows
2025-09-17 02:41:19,519 - INFO - Data shape after removing duplicates: (12205, 18)
2025-09-17 02:41:19,519 - INFO - Converting boolean columns to integers
2025-09-17 02:41:19,520 - INFO - Creating interaction features
2025-09-17 02:41:19,522 - INFO - Applying target encoding for Month
2025-09-17 02:41:19,529 - INFO - Applying frequency encoding for VisitorType
2025-09-17 02:41:19,531 - INFO - Transforming skewed features
2025-09-17 02:41:19,567 - INFO - Applying SMOTE to handle class imbalance
2025-09-17 02:41:19,762 - INFO - Scaling features
2025-09-17 02:41:19,774 - INFO - Applying PCA for dimensionality reduction
2025-09-17 02:41:19,795 - INFO - PCA reduced features to: 15 components
2025-09-17 02:41:19,795 - INFO - Applying K-Means clustering
2025-09-17 02:41:44,339 - INFO - Optimal number of clusters: 3
2025-09-17 02:41:44,445 - INFO - Combining PCA features with cluster labels
2025-09-17 02:41:44,446 - INFO - Saving preprocessed data
2025-09-17 02:41:44,831 - INFO - Data saved successfully to datasets/processed\preprocessed_data.csv
2025-09-17 02:41:44,833 - INFO - PowerTransformer saved to datasets/processed\power_transformer.pkl
2025-09-17 02:41:44,834 - INFO - Scaler saved to datasets/processed\scaler.pkl
2025-09-17 02:41:44,835 - INFO - PCA model saved to datasets/processed\pca.pkl
2025-09-17 02:41:44,837 - INFO - K-Means model saved to datasets/processed\kmeans.pkl
2025-09-17 02:41:44,979 - INFO - Data saved successfully to datasets/processed\clean.csv
2025-09-17 02:41:44,979 - INFO - Data preprocessing completed successfully
2025-09-17 02:41:44,982 - INFO - Loading preprocessed data from datasets/processed\preprocessed_data.csv
2025-09-17 02:41:44,982 - INFO - Loading data from datasets/processed\preprocessed_data.csv
2025-09-17 02:41:45,044 - INFO - Data loaded successfully. Shape: (20594, 18)
2025-09-17 02:41:45,050 - INFO - Training set: (16475, 16), Testing set: (4119, 16)
2025-09-17 02:41:56,768 - INFO - XGBoost - Best F1 Score: 0.8884, Test F1 Score: 0.8837
2025-09-17 02:42:06,850 - INFO - LightGBM - Best F1 Score: 0.8873, Test F1 Score: 0.8819
2025-09-17 02:42:55,859 - INFO - RandomForest - Best F1 Score: 0.8893, Test F1 Score: 0.8884
2025-09-17 02:43:44,319 - INFO - GradientBoosting - Best F1 Score: 0.8892, Test F1 Score: 0.8807
2025-09-17 02:43:44,331 - INFO - 
Model Comparison:
                  accuracy precision    recall        f1   roc_auc  cv_score
RandomForest      0.887109  0.878083   0.89898  0.888409  0.953085  0.889276
XGBoost           0.882981  0.877815  0.889752  0.883743  0.950892   0.88842
LightGBM          0.881039  0.875539  0.888295  0.881871  0.950012  0.887344
GradientBoosting  0.880311  0.877896  0.883439  0.880658  0.949823  0.889193
2025-09-17 02:43:44,332 - INFO - 
Best model: RandomForest
2025-09-17 02:43:44,401 - INFO - Accuracy: 0.8871
2025-09-17 02:43:44,404 - INFO - Precision: 0.8781
2025-09-17 02:43:44,408 - INFO - Recall: 0.8990
2025-09-17 02:43:44,411 - INFO - F1 Score: 0.8884
2025-09-17 02:43:44,414 - INFO - ROC AUC: 0.9531
2025-09-17 02:43:44,425 - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.88      0.89      2060
           1       0.88      0.90      0.89      2059

    accuracy                           0.89      4119
   macro avg       0.89      0.89      0.89      4119
weighted avg       0.89      0.89      0.89      4119

2025-09-17 02:43:44,570 - INFO - 
Overfitting Check:
2025-09-17 02:43:44,579 - INFO - Train F1 Score: 0.9452
2025-09-17 02:43:44,582 - INFO - Test F1 Score: 0.8884
2025-09-17 02:43:44,591 - INFO - Train ROC AUC: 0.9849
2025-09-17 02:43:44,595 - INFO - Test ROC AUC: 0.9531
2025-09-17 02:43:44,642 - INFO - Best model saved to models\best_model.pkl
2025-09-17 02:43:44,643 - INFO - Generating evaluation plots (model metrics)
2025-09-17 02:43:45,232 - INFO - Saved confusion matrix plot to static/plots/confusion_matrix_RandomForest.png
2025-09-17 02:43:45,358 - INFO - Saved ROC curve plot to static/plots/roc_curve_RandomForest.png
2025-09-17 02:43:45,407 - INFO - Generating feature importance plot
2025-09-17 02:43:45,721 - INFO - Saved feature importance plot to static/plots/feature_importance_RandomForest.png
2025-09-17 02:43:45,722 - INFO - Model training completed successfully
2025-09-17 02:43:45,729 - INFO - Training completed successfully
2025-09-17 02:43:45,730 - INFO - Training completed successfully
2025-09-17 02:44:21,694 - INFO - GET /train → train.html
2025-09-17 02:44:40,357 - INFO - Logger initialized
2025-09-17 02:44:42,782 - INFO - No GPU detected - using CPU only
2025-09-17 02:44:42,783 - INFO - Initializing Dash app at /eda/
2025-09-17 02:44:43,267 - INFO - Successfully loaded clean.csv
2025-09-17 02:44:44,447 - INFO - Dash app layout set up
2025-09-17 02:44:44,447 - INFO - Dash app initialized at /eda/
2025-09-17 02:44:44,491 - INFO - Model loaded successfully at startup
2025-09-17 02:44:44,638 - INFO - GET /train → train.html
2025-09-17 02:46:19,380 - INFO - GET /train → train.html
2025-09-17 02:46:29,602 - INFO - Logger initialized
2025-09-17 02:46:31,789 - INFO - No GPU detected - using CPU only
2025-09-17 02:46:31,791 - INFO - Initializing Dash app at /eda/
2025-09-17 02:46:32,240 - INFO - Successfully loaded clean.csv
2025-09-17 02:46:33,247 - INFO - Dash app layout set up
2025-09-17 02:46:33,248 - INFO - Dash app initialized at /eda/
2025-09-17 02:46:33,281 - INFO - Model loaded successfully at startup
2025-09-17 02:46:33,456 - INFO - GET /train → train.html
2025-09-17 02:57:23,444 - INFO - Logger initialized
2025-09-17 02:57:25,748 - INFO - No GPU detected - using CPU only
2025-09-17 02:57:25,749 - INFO - Initializing Dash app at /eda/
2025-09-17 02:57:26,188 - INFO - Successfully loaded clean.csv
2025-09-17 02:57:27,287 - INFO - Dash app layout set up
2025-09-17 02:57:27,288 - INFO - Dash app initialized at /eda/
2025-09-17 02:57:27,322 - INFO - Model loaded successfully at startup
2025-09-17 02:57:27,414 - INFO - GET /train → train.html
2025-09-17 02:59:40,301 - INFO - GET /train → train.html
2025-09-17 03:01:02,815 - INFO - Logger initialized
2025-09-17 03:01:05,331 - INFO - No GPU detected - using CPU only
2025-09-17 03:01:05,332 - INFO - Initializing Dash app at /eda/
2025-09-17 03:01:05,854 - INFO - Successfully loaded clean.csv
2025-09-17 03:01:07,051 - INFO - Dash app layout set up
2025-09-17 03:01:07,051 - INFO - Dash app initialized at /eda/
2025-09-17 03:01:07,086 - INFO - Model loaded successfully at startup
2025-09-17 03:01:07,174 - INFO - GET /train → train.html
2025-09-17 03:02:19,675 - INFO - GET /train → train.html
2025-09-17 03:02:36,392 - INFO - Logger initialized
2025-09-17 03:02:38,823 - INFO - No GPU detected - using CPU only
2025-09-17 03:02:38,825 - INFO - Initializing Dash app at /eda/
2025-09-17 03:02:39,280 - INFO - Successfully loaded clean.csv
2025-09-17 03:02:40,425 - INFO - Dash app layout set up
2025-09-17 03:02:40,425 - INFO - Dash app initialized at /eda/
2025-09-17 03:02:40,458 - INFO - Model loaded successfully at startup
2025-09-17 03:02:40,543 - INFO - GET /train → train.html
2025-09-17 03:04:23,183 - INFO - Logger initialized
2025-09-17 03:04:25,487 - INFO - No GPU detected - using CPU only
2025-09-17 03:04:25,489 - INFO - Initializing Dash app at /eda/
2025-09-17 03:04:25,933 - INFO - Successfully loaded clean.csv
2025-09-17 03:04:26,981 - INFO - Dash app layout set up
2025-09-17 03:04:26,982 - INFO - Dash app initialized at /eda/
2025-09-17 03:04:27,015 - INFO - Model loaded successfully at startup
2025-09-17 03:04:27,225 - INFO - GET /train → train.html
2025-09-17 03:05:22,234 - INFO - Logger initialized
2025-09-17 03:05:24,621 - INFO - No GPU detected - using CPU only
2025-09-17 03:05:24,622 - INFO - Initializing Dash app at /eda/
2025-09-17 03:05:25,128 - INFO - Successfully loaded clean.csv
2025-09-17 03:05:26,228 - INFO - Dash app layout set up
2025-09-17 03:05:26,229 - INFO - Dash app initialized at /eda/
2025-09-17 03:05:26,260 - INFO - Model loaded successfully at startup
2025-09-17 03:05:26,496 - INFO - GET /train → train.html
2025-09-17 03:06:17,918 - INFO - GET /train → train.html
2025-09-17 03:07:01,064 - INFO - GET /train → train.html
2025-09-17 03:07:21,517 - INFO - GET /train → train.html
2025-09-17 03:07:24,092 - INFO - GET /predict → predict.html
2025-09-17 03:11:21,575 - INFO - GET /predict → predict.html
2025-09-17 03:19:24,780 - INFO - Logger initialized
2025-09-17 03:19:27,231 - INFO - No GPU detected - using CPU only
2025-09-17 03:19:27,233 - INFO - Initializing Dash app at /eda/
2025-09-17 03:19:27,704 - INFO - Successfully loaded clean.csv
2025-09-17 03:19:29,537 - INFO - Dash app layout set up
2025-09-17 03:19:29,538 - INFO - Dash app initialized at /eda/
2025-09-17 03:19:29,578 - INFO - Model loaded successfully at startup
2025-09-17 03:19:30,240 - INFO - GET /predict → predict.html
2025-09-17 03:20:37,589 - INFO - GET /predict → predict.html
2025-09-17 03:25:48,336 - INFO - Logger initialized
2025-09-17 03:25:50,518 - INFO - No GPU detected - using CPU only
2025-09-17 03:25:50,519 - INFO - Initializing Dash app at /eda/
2025-09-17 03:25:51,024 - INFO - Successfully loaded clean.csv
2025-09-17 03:25:52,135 - INFO - Dash app layout set up
2025-09-17 03:25:52,136 - INFO - Dash app initialized at /eda/
2025-09-17 03:25:52,169 - INFO - Model loaded successfully at startup
2025-09-17 03:25:54,244 - INFO - GET /predict → predict.html
2025-09-17 09:27:16,321 - INFO - Logger initialized
2025-09-17 09:27:24,750 - INFO - No GPU detected - using CPU only
2025-09-17 09:27:24,754 - INFO - Initializing Dash app at /eda/
2025-09-17 09:27:26,075 - INFO - Successfully loaded clean.csv
2025-09-17 09:27:31,533 - INFO - Dash app layout set up
2025-09-17 09:27:31,533 - INFO - Dash app initialized at /eda/
2025-09-17 09:27:31,622 - INFO - Model loaded successfully at startup
2025-09-17 09:27:31,974 - INFO - GET /home → home.html
2025-09-17 09:30:50,848 - INFO - GET /home → home.html
2025-09-17 09:31:06,679 - INFO - Logger initialized
2025-09-17 09:31:08,979 - INFO - No GPU detected - using CPU only
2025-09-17 09:31:08,979 - INFO - Initializing Dash app at /eda/
2025-09-17 09:31:09,430 - INFO - Successfully loaded clean.csv
2025-09-17 09:31:10,563 - INFO - Dash app layout set up
2025-09-17 09:31:10,563 - INFO - Dash app initialized at /eda/
2025-09-17 09:31:10,593 - INFO - Model loaded successfully at startup
2025-09-17 09:31:10,835 - INFO - GET /home → home.html
2025-09-17 09:31:59,667 - INFO - GET /train → train.html
2025-09-17 10:02:31,950 - INFO - GET /predict → predict.html
2025-09-17 10:03:24,784 - INFO - GET /home → home.html
2025-09-17 10:59:55,878 - INFO - GET /train → train.html
2025-09-17 11:00:00,329 - INFO - GET /predict → predict.html
2025-09-17 11:00:18,375 - INFO - POST /predict
2025-09-17 11:00:18,376 - INFO - Predict payload: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 11:00:18,479 - INFO - Preprocessing single instance: {'Administrative': 0.0, 'Administrative_Duration': 0.0, 'Informational': 0.0, 'Informational_Duration': 0.0, 'ProductRelated': 1.0, 'ProductRelated_Duration': 0.0, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': 0.0, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month': 'Aug', 'VisitorType': 'Returning_Visitor'}
2025-09-17 11:00:18,494 - INFO - Features before scaling and PCA: {'Administrative': 0.0, 'Administrative_Duration': -1.0054680759288452, 'Informational': 0.0, 'Informational_Duration': -0.4947987296998535, 'ProductRelated': 1.0, 'ProductRelated_Duration': -2.168082124275048, 'BounceRates': 0.2, 'ExitRates': 0.2, 'PageValues': -0.5328007247722796, 'SpecialDay': 0.0, 'OperatingSystems': 1, 'Browser': 1, 'Region': 1, 'TrafficType': 1, 'Weekend': 0, 'Month_Encoded': 0.17551963048498845, 'VisitorType_Freq': 0.8546497337156903, 'Total_PageViews': 1.0, 'Total_Duration': 0.0, 'Avg_Time_Per_Page': 0.0, 'Bounce_Exit_Ratio': 0.9950248756218906, 'Engagement_Score': 0.4}
2025-09-17 11:00:18,562 - INFO - Prediction: 0, Probability: [0.98933446 0.01066554]
2025-09-17 11:00:26,364 - INFO - GET /home → home.html
2025-09-17 13:58:18,967 - INFO - Logger initialized
2025-09-17 13:58:21,729 - INFO - No GPU detected - using CPU only
2025-09-17 13:58:21,729 - INFO - Initializing Dash app at /eda/
2025-09-17 13:58:22,195 - INFO - Successfully loaded clean.csv
2025-09-17 13:58:23,835 - INFO - Dash app layout set up
2025-09-17 13:58:23,836 - INFO - Dash app initialized at /eda/
2025-09-17 13:58:23,859 - INFO - Model loaded successfully at startup
2025-09-17 13:58:23,992 - INFO - GET /train → train.html
2025-09-17 14:01:53,997 - INFO - Logger initialized
2025-09-17 14:01:56,229 - INFO - No GPU detected - using CPU only
2025-09-17 14:01:56,229 - INFO - Initializing Dash app at /eda/
2025-09-17 14:01:56,680 - INFO - Successfully loaded clean.csv
2025-09-17 14:01:57,755 - INFO - Dash app layout set up
2025-09-17 14:01:57,756 - INFO - Dash app initialized at /eda/
2025-09-17 14:01:57,778 - INFO - Model loaded successfully at startup
2025-09-17 14:01:57,936 - INFO - GET /train → train.html
2025-09-17 14:02:38,900 - INFO - GET /predict → predict.html
2025-09-17 14:04:32,500 - INFO - Logger initialized
2025-09-17 14:04:34,660 - INFO - No GPU detected - using CPU only
2025-09-17 14:04:34,675 - INFO - Initializing Dash app at /eda/
2025-09-17 14:04:35,130 - INFO - Successfully loaded clean.csv
2025-09-17 14:04:36,200 - INFO - Dash app layout set up
2025-09-17 14:04:36,201 - INFO - Dash app initialized at /eda/
2025-09-17 14:04:36,226 - INFO - Model loaded successfully at startup
2025-09-17 14:04:36,428 - INFO - GET /predict → predict.html
2025-09-17 14:09:47,649 - INFO - Logger initialized
2025-09-17 14:09:49,960 - INFO - No GPU detected - using CPU only
2025-09-17 14:09:49,975 - INFO - Initializing Dash app at /eda/
2025-09-17 14:09:50,467 - INFO - Successfully loaded clean.csv
2025-09-17 14:09:51,539 - INFO - Dash app layout set up
2025-09-17 14:09:51,540 - INFO - Dash app initialized at /eda/
2025-09-17 14:09:51,575 - INFO - Model loaded successfully at startup
2025-09-17 14:09:51,708 - INFO - GET /predict → predict.html
2025-09-17 14:09:55,905 - INFO - GET /home → home.html
2025-09-17 14:09:58,694 - INFO - GET /train → train.html
2025-09-17 14:10:32,191 - INFO - GET /home → home.html
2025-09-17 14:16:05,428 - INFO - GET /predict → predict.html
2025-09-17 14:16:51,264 - INFO - GET /predict → predict.html
2025-09-17 14:17:18,163 - INFO - GET /predict → predict.html
2025-09-17 14:17:25,002 - INFO - GET /home → home.html
2025-09-17 14:20:22,938 - INFO - GET /predict → predict.html
2025-09-17 14:30:56,396 - INFO - GET /predict → predict.html
2025-09-17 14:31:07,051 - INFO - Logger initialized
2025-09-17 14:31:09,312 - INFO - No GPU detected - using CPU only
2025-09-17 14:31:09,314 - INFO - Initializing Dash app at /eda/
2025-09-17 14:31:09,770 - INFO - Successfully loaded clean.csv
2025-09-17 14:31:10,934 - INFO - Dash app layout set up
2025-09-17 14:31:10,935 - INFO - Dash app initialized at /eda/
2025-09-17 14:31:10,969 - INFO - Model loaded successfully at startup
2025-09-17 14:31:11,956 - INFO - GET /predict → predict.html
2025-09-17 14:32:29,207 - INFO - GET /predict → predict.html
2025-09-17 14:32:31,185 - INFO - GET /home → home.html
